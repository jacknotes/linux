select TrvId,(case SUM(owe) when 0 then '是'  else '否' end) as 是否全额到账
,sum(owe) as 欠款金额,sum(cash+cpay+bpay+vpay+tpay) as 到账金额 from tbTrvKhSk 
where Skstatus<>2
and TrvId in 
('27145','27132','27120','27119','27118','27101','27100','27091','27090','27089','27088','27087','27086','27085','27084','27083','27082','27081','27080','27079','27078','27077','27054','27053','27052','27051','27050','27049','27048','27047','27046','27045','27044','27043','27030','27016','27015','27014','27013','27012','27010','26997','26993','26936','26935','26933','26932','26931','26930','26929','26928','26926','26925','26924','26923','26922','26921','26920','26919','26918','26917','26916','26915','26914','26913','26912','26911','26887','26884','26864','26841','26800','26795','26794','26689','26503')
group by TrvId


select ConventionId,(case SUM(owe) when 0 then '是'  else '否' end) as 是否全额到账
,sum(owe) as 欠款金额,sum(cash+cpay+bpay+vpay+tpay) as 到账金额 from tbConventionKhSk 
where Skstatus<>2
and ConventionId in 
('700','698','697','695','691','688','686','685','682','679','677','674','671','667','663','660','654','649','648','644','640','633','630','629','627','626','623','593','728','726','725','720','719','718','717','714','710','709','708','707','706','704','692')
group by ConventionId