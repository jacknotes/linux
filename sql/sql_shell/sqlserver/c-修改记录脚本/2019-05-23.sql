--2018年UC019830提前7天内出票数据 
select  coupno,DATEDIFF(DD,[datetime],begdate)提前出票天数,pasname,datetime,begdate
from Topway..tbcash 
where DATEDIFF(DD,datetime,begdate)<=7
--and begdate>=[datetime]
and datetime>='2018-01-01'
and datetime<'2019-01-01'
and cmpcode='019830'
AND tickettype='电子票'
order by 提前出票天数 desc

--机型增加
--select * from ehomsom..tbPlanetype order by id
insert into ehomsom..tbPlanetype (id,manufacturer,btype,ltype,aname,wingspan,[length],high,maxseat,intro,pic,tax) values(139,'空客','A330系列','33A','33A',null,null,null,null,'宽体',null,null)
insert into ehomsom..tbPlanetype (id,manufacturer,btype,ltype,aname,wingspan,[length],high,maxseat,intro,pic,tax) values(140,'空客','A330系列','33A','33A',null,null,null,null,'宽体',null,null)

--单位客户授信额度调整
select SX_TotalCreditLine,* from Topway..AccountStatement 
--update Topway..AccountStatement set SX_TotalCreditLine=800000
where BillNumber='020350_20190501'


--修改退票审核日期
select ExamineDate,* from Topway..tbReti 
--update Topway..tbReti set ExamineDate='2019-05-15'
where reno='0435797'

--财务核销修改成未付
select status,* from Topway..tbcash 
--update Topway..tbcash set status=0
where coupno in ('AS002283461',
'AS002284433',
'AS002286622',
'AS002286826',
'AS002286840',
'AS002287020',
'AS002287022',
'AS002288257',
'AS002288243',
'AS002288243',
'AS002288243',
'AS002290285',
'AS002290285',
'AS002292931',
'AS002292963',
'AS002292963',
'AS002292963',
'AS002293343',
'AS002293343',
'AS002303051',
'AS002303063',
'AS002305920',
'AS002305920',
'AS002311021',
'AS002311027',
'AS002312698',
'AS002312704',
'AS002324151',
'AS002324151',
'AS002330723',
'AS002330723',
'AS002331731',
'AS002331716',
'AS002335641',
'AS002335641',
'AS002335637',
'AS002335637',
'AS002340100',
'AS002340100',
'AS002340176',
'AS002355481',
'AS002358845')

--旅游收款单信息
select Skstatus,* from Topway..tbTrvKhSk 
--update Topway..tbTrvKhSk set Skstatus=2
where TrvId='30001'

--删除到账
select * 
--delete
from Topway..FinanceERP_ClientBankRealIncomeDetail where date='2019-05-22' and money='279430.66'

--补退款业务流水号
select AcountInfo,PayType,* from Topway..tbTrvKhTk 
--update Topway..tbTrvKhTk set AcountInfo='||==||2019051622001459971038972677||==||||==||',PayType='支付宝支付'
where TrvId='30097'

select AcountInfo,PayType,* from Topway..tbTrvKhTk 
--update Topway..tbTrvKhTk set AcountInfo='||==||2019051622001459971038698634||==||||==||',PayType='支付宝支付'
where TrvId='30096'


select top 100* from homsomDB..Trv_Human where NationID<>'369F3545-9E79-4F32-82A5-A15C01244B52'

--拉取除表格中客户以外的且申请国内特殊票价为是的客户的常旅客名单数字,国内机票的常旅客名单
--1,2018.1.1-2019.4.30出过机票名单数
--2,每家公司的常旅客名单中外籍客户的名单个数。



if  OBJECT_ID('tempdb..#rs') is not null drop table #rs
select cmpcode,pasname,count(1)张数
into #rs
from Topway..tbcash with (nolock)
where cmpcode in ('017858',
'017595',
'016310',
'016346',
'017622',
'017776',
'017543',
'016504',
'016719',
'016239',
'000037',
'017182',
'016337',
'017012',
'016724',
'017505',
'016848',
'017286',
'016352',
'017916',
'014539',
'016515',
'016813',
'017753',
'016938',
'016289',
'017851',
'016321',
'017223',
'017888',
'017029',
'017508',
'016400',
'017426',
'017519',
'017920',
'017930',
'017947',
'017954',
'017955',
'017989',
'018002',
'018003',
'018038',
'018042',
'018047',
'018061',
'016962',
'018094',
'018131',
'018134',
'018173',
'018193',
'018202',
'018278',
'018299',
'018303',
'018304',
'018240',
'018259',
'018331',
'018341',
'018345',
'018385',
'018400',
'018419',
'018435',
'018463',
'018487',
'018490',
'018570',
'018589',
'018625',
'018669',
'018670',
'018711',
'018732',
'018756',
'018758',
'018790',
'018805',
'018809',
'018744',
'018822',
'018831',
'018868',
'018882',
'018896',
'018890',
'018910',
'018919',
'018926',
'018945',
'019006',
'019051',
'019054',
'019158',
'019180',
'019216',
'019219',
'019227',
'019189',
'019195',
'019258',
'019261',
'019301',
'019348',
'019334',
'019347',
'019401',
'019403',
'019411',
'019450',
'019455',
'019476',
'019484',
'019497',
'019535',
'019568',
'017055',
'019587',
'019588',
'019609',
'019634',
'019640',
'019656',
'019674',
'019670',
'019704',
'019713',
'019736',
'019753',
'019772',
'019774',
'019775',
'019780',
'019764',
'019802',
'019817',
'019827',
'019830',
'019840',
'019844',
'019845',
'019850',
'019863',
'019866',
'019884',
'019892',
'019919',
'019929',
'019934',
'019951',
'019953',
'019958',
'019961',
'019970',
'019972',
'019987',
'019988',
'019989',
'019991',
'020002',
'020023',
'020027',
'020033',
'020072',
'020087',
'020106',
'017202',
'020119',
'020146',
'020163',
'020166',
'020183',
'020184',
'016961',
'020249',
'020286',
'020341',
'020416',
'020419',
'020426',
'020466',
'020486',
'020488',
'020476',
'020495',
'020507',
'020510',
'020518',
'020536',
'020544',
'020555',
'020548',
'020602',
'020622',
'020626',
'020631',
'020641',
'020667',
'020674',
'020690',
'020726',
'020734',
'020761',
'020777',
'020801',
'020805',
'020812',
'017659',
'020820',
'017655',
'016482',
'016061',
'002045',
'017065',
'017474',
'016709',
'017283',
'016884',
'016936',
'016363',
'017285',
'017189',
'016834',
'016309',
'017016',
'006944',
'017569',
'016635',
'017007',
'017327',
'017624',
'016670',
'017578',
'017200',
'017565',
'017150',
'016264',
'009005',
'017754',
'016336',
'016525',
'017577',
'017392',
'016213',
'016267',
'017122',
'016858',
'016826',
'017326',
'020817',
'020803',
'020799',
'020784',
'020771',
'020774',
'020763',
'020741',
'020747',
'020753',
'020756',
'020758',
'016379',
'020737',
'020729',
'020679',
'020680',
'020684',
'020695',
'020701',
'020709',
'017088',
'020651',
'020664',
'020639',
'020629',
'020630',
'020617',
'020621',
'020579',
'020583',
'020594',
'020598',
'020570',
'020556',
'020483',
'020547',
'020538',
'020508',
'020490',
'020470',
'020475',
'020447',
'020453',
'020455',
'020327',
'020334',
'020304',
'020305',
'020308',
'020161',
'020283',
'020289',
'020291',
'020293',
'020294',
'020296',
'020345',
'020346',
'020349',
'020351',
'020354',
'020355',
'020366',
'020371',
'020338',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020253',
'020260',
'020207',
'020214',
'020218',
'020263',
'020264',
'020268',
'020269',
'020272',
'020187',
'020192',
'020195',
'020196',
'020199',
'020200',
'020221',
'020224',
'020228',
'020231',
'016890',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020171',
'020173',
'020174',
'020147',
'020148',
'020149',
'020150',
'020127',
'020138',
'020142',
'020095',
'020111',
'020112',
'020115',
'020118',
'020038',
'019969',
'020069',
'020053',
'020061',
'020062',
'020063',
'020028',
'020029',
'019982',
'020021',
'020022',
'020003',
'019992',
'019997',
'019998',
'020001',
'019959',
'019939',
'019941',
'019943',
'019812',
'019908',
'019842',
'019843',
'019794',
'019799',
'019786',
'019788',
'019757',
'019760',
'019727',
'019731',
'019737',
'017020',
'019749',
'019629',
'019712',
'019679',
'019658',
'019594',
'019603',
'019584',
'019607',
'019507',
'019524',
'019436',
'019465',
'019475',
'019461',
'019420',
'019429',
'019365',
'019366',
'019393',
'019333',
'019284',
'019212',
'019252',
'019234',
'019159',
'018929',
'019121',
'019072',
'019097',
'019023',
'019011',
'018964',
'018967',
'018981',
'018989',
'018937',
'018911',
'018900',
'018886',
'018834',
'018814',
'018816',
'018766',
'018767',
'018567',
'018720',
'018633',
'018627',
'018608',
'018610',
'018580',
'018537',
'018486',
'018509',
'018546',
'018412',
'018367',
'018382',
'018271',
'018037',
'018326',
'018220',
'018176',
'017999',
'018103',
'017985',
'017986',
'017932',
'017939',
'017921',
'017924',
'017146',
'017919',
'017400',
'016344',
'017872',
'017800',
'016532',
'017786',
'016362',
'017533',
'017893',
'016428',
'013184',
'016976',
'017579',
'017480',
'017128',
'017033',
'013909',
'017429',
'016414',
'017549',
'017886',
'016617',
'017762',
'007638',
'016646',
'017559',
'017557',
'016500',
'006596',
'017154',
'016287',
'017680',
'017364',
'016420',
'016554',
'017191',
'016426',
'016713',
'017996',
'018114',
'018030',
'018408',
'018539',
'018541',
'018676',
'018731',
'018743',
'018751',
'018925',
'019462',
'019463',
'019448',
'019583',
'019691',
'019692',
'019721',
'019735',
'019878',
'019990',
'020045',
'020100',
'020114',
'020107',
'020110',
'020085',
'020132',
'020273',
'020282',
'020215',
'020384',
'020298',
'020302',
'020462',
'020472',
'020477',
'020533',
'020545',
'020571',
'020569',
'020637',
'020665',
'020655',
'020643',
'020720',
'020696',
'020685',
'020694',
'020733',
'020727',
'020742',
'020766',
'020724',
'016664',
'017415',
'016448',
'017300',
'017547',
'017664',
'016596',
'017056',
'017663',
'017649',
'017504',
'017101',
'017654',
'017495',
'017399',
'017368',
'016490',
'016262',
'017873',
'017667',
'016886',
'016294',
'017652',
'020804',
'020786',
'020818',
'017827',
'016795',
'020739',
'020675',
'020698',
'020699',
'020723',
'020718',
'020646',
'020649',
'020656',
'020553',
'020560',
'020561',
'020567',
'020591',
'020603',
'020497',
'020514',
'020491',
'020456',
'020430',
'020425',
'020288',
'020312',
'020314',
'020315',
'020324',
'020335',
'020342',
'020372',
'020360',
'020364',
'020212',
'020261',
'020266',
'020219',
'020204',
'020191',
'020141',
'020128',
'020130',
'020124',
'020155',
'020157',
'020180',
'020181',
'020091',
'020094',
'020113',
'020096',
'020099',
'020065',
'019983',
'019979',
'016531',
'020005',
'020015',
'020016',
'019882',
'019901',
'019792',
'019771',
'019807',
'019855',
'019784',
'019708',
'019673',
'019653',
'019655',
'019638',
'017643',
'019628',
'019592',
'019604',
'016618',
'019520',
'019580',
'019540',
'019557',
'019435',
'019442',
'019502',
'019506',
'019486',
'019145',
'018930',
'019177',
'019183',
'019235',
'019249',
'019205',
'019230',
'019231',
'019273',
'019290',
'019292',
'016307',
'019352',
'019360',
'019363',
'018928',
'018938',
'018940',
'018943',
'018902',
'018906',
'018892',
'018999',
'019018',
'019021',
'019026',
'019036',
'019049',
'017661',
'019110',
'018813',
'018838',
'018833',
'018873',
'018773',
'018690',
'018692',
'018701',
'018702',
'018707',
'018724',
'018726',
'018714',
'018591',
'018605',
'018632',
'018626',
'018652',
'018671',
'018495',
'018480',
'018451',
'018556',
'018560',
'018563',
'018522',
'018524',
'018536',
'018232',
'018197',
'018199',
'018308',
'018318',
'018319',
'018281',
'018283',
'018291',
'018296',
'018343',
'018415',
'018418',
'018420',
'018407',
'018395',
'018116',
'018125',
'018141',
'018161',
'018080',
'018014',
'018017',
'017956',
'017957',
'017978',
'017980',
'017944',
'017931',
'016284',
'017822',
'016720',
'016132',
'017914',
'017682',
'017319',
'017454',
'017449',
'016610',
'016588',
'017493',
'016773',
'016087',
'017325',
'017623',
'017700',
'016354',
'017257',
'017740',
'016266',
'016492',
'017217',
'016358',
'017574',
'016339',
'017709',
'016348',
'016859',
'016640',
'016707',
'013174',
'017377',
'017135',
'017258',
'016402')
and datetime>'2018-01-01'
and datetime<'2019-04-30'
and inf=0
group by pasname,cmpcode
order by cmpcode

--出票人数
select cmpcode,COUNT(1) from #rs
group by cmpcode

--外籍员工人数
select top 100 * from homsomDB..Trv_Human


select Cmpid,COUNT(1) from homsomDB..Trv_Human h
left join homsomDB..Trv_UnitPersons u on u.ID=h.ID
left join homsomDB..Trv_UnitCompanies un on un.ID=u.CompanyID
where IsDisplay=1
and h.NationID!='369F3545-9E79-4F32-82A5-A15C01244B52'
and Cmpid in ('017858',
'017595',
'016310',
'016346',
'017622',
'017776',
'017543',
'016504',
'016719',
'016239',
'000037',
'017182',
'016337',
'017012',
'016724',
'017505',
'016848',
'017286',
'016352',
'017916',
'014539',
'016515',
'016813',
'017753',
'016938',
'016289',
'017851',
'016321',
'017223',
'017888',
'017029',
'017508',
'016400',
'017426',
'017519',
'017920',
'017930',
'017947',
'017954',
'017955',
'017989',
'018002',
'018003',
'018038',
'018042',
'018047',
'018061',
'016962',
'018094',
'018131',
'018134',
'018173',
'018193',
'018202',
'018278',
'018299',
'018303',
'018304',
'018240',
'018259',
'018331',
'018341',
'018345',
'018385',
'018400',
'018419',
'018435',
'018463',
'018487',
'018490',
'018570',
'018589',
'018625',
'018669',
'018670',
'018711',
'018732',
'018756',
'018758',
'018790',
'018805',
'018809',
'018744',
'018822',
'018831',
'018868',
'018882',
'018896',
'018890',
'018910',
'018919',
'018926',
'018945',
'019006',
'019051',
'019054',
'019158',
'019180',
'019216',
'019219',
'019227',
'019189',
'019195',
'019258',
'019261',
'019301',
'019348',
'019334',
'019347',
'019401',
'019403',
'019411',
'019450',
'019455',
'019476',
'019484',
'019497',
'019535',
'019568',
'017055',
'019587',
'019588',
'019609',
'019634',
'019640',
'019656',
'019674',
'019670',
'019704',
'019713',
'019736',
'019753',
'019772',
'019774',
'019775',
'019780',
'019764',
'019802',
'019817',
'019827',
'019830',
'019840',
'019844',
'019845',
'019850',
'019863',
'019866',
'019884',
'019892',
'019919',
'019929',
'019934',
'019951',
'019953',
'019958',
'019961',
'019970',
'019972',
'019987',
'019988',
'019989',
'019991',
'020002',
'020023',
'020027',
'020033',
'020072',
'020087',
'020106',
'017202',
'020119',
'020146',
'020163',
'020166',
'020183',
'020184',
'016961',
'020249',
'020286',
'020341',
'020416',
'020419',
'020426',
'020466',
'020486',
'020488',
'020476',
'020495',
'020507',
'020510',
'020518',
'020536',
'020544',
'020555',
'020548',
'020602',
'020622',
'020626',
'020631',
'020641',
'020667',
'020674',
'020690',
'020726',
'020734',
'020761',
'020777',
'020801',
'020805',
'020812',
'017659',
'020820',
'017655',
'016482',
'016061',
'002045',
'017065',
'017474',
'016709',
'017283',
'016884',
'016936',
'016363',
'017285',
'017189',
'016834',
'016309',
'017016',
'006944',
'017569',
'016635',
'017007',
'017327',
'017624',
'016670',
'017578',
'017200',
'017565',
'017150',
'016264',
'009005',
'017754',
'016336',
'016525',
'017577',
'017392',
'016213',
'016267',
'017122',
'016858',
'016826',
'017326',
'020817',
'020803',
'020799',
'020784',
'020771',
'020774',
'020763',
'020741',
'020747',
'020753',
'020756',
'020758',
'016379',
'020737',
'020729',
'020679',
'020680',
'020684',
'020695',
'020701',
'020709',
'017088',
'020651',
'020664',
'020639',
'020629',
'020630',
'020617',
'020621',
'020579',
'020583',
'020594',
'020598',
'020570',
'020556',
'020483',
'020547',
'020538',
'020508',
'020490',
'020470',
'020475',
'020447',
'020453',
'020455',
'020327',
'020334',
'020304',
'020305',
'020308',
'020161',
'020283',
'020289',
'020291',
'020293',
'020294',
'020296',
'020345',
'020346',
'020349',
'020351',
'020354',
'020355',
'020366',
'020371',
'020338',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020253',
'020260',
'020207',
'020214',
'020218',
'020263',
'020264',
'020268',
'020269',
'020272',
'020187',
'020192',
'020195',
'020196',
'020199',
'020200',
'020221',
'020224',
'020228',
'020231',
'016890',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020171',
'020173',
'020174',
'020147',
'020148',
'020149',
'020150',
'020127',
'020138',
'020142',
'020095',
'020111',
'020112',
'020115',
'020118',
'020038',
'019969',
'020069',
'020053',
'020061',
'020062',
'020063',
'020028',
'020029',
'019982',
'020021',
'020022',
'020003',
'019992',
'019997',
'019998',
'020001',
'019959',
'019939',
'019941',
'019943',
'019812',
'019908',
'019842',
'019843',
'019794',
'019799',
'019786',
'019788',
'019757',
'019760',
'019727',
'019731',
'019737',
'017020',
'019749',
'019629',
'019712',
'019679',
'019658',
'019594',
'019603',
'019584',
'019607',
'019507',
'019524',
'019436',
'019465',
'019475',
'019461',
'019420',
'019429',
'019365',
'019366',
'019393',
'019333',
'019284',
'019212',
'019252',
'019234',
'019159',
'018929',
'019121',
'019072',
'019097',
'019023',
'019011',
'018964',
'018967',
'018981',
'018989',
'018937',
'018911',
'018900',
'018886',
'018834',
'018814',
'018816',
'018766',
'018767',
'018567',
'018720',
'018633',
'018627',
'018608',
'018610',
'018580',
'018537',
'018486',
'018509',
'018546',
'018412',
'018367',
'018382',
'018271',
'018037',
'018326',
'018220',
'018176',
'017999',
'018103',
'017985',
'017986',
'017932',
'017939',
'017921',
'017924',
'017146',
'017919',
'017400',
'016344',
'017872',
'017800',
'016532',
'017786',
'016362',
'017533',
'017893',
'016428',
'013184',
'016976',
'017579',
'017480',
'017128',
'017033',
'013909',
'017429',
'016414',
'017549',
'017886',
'016617',
'017762',
'007638',
'016646',
'017559',
'017557',
'016500',
'006596',
'017154',
'016287',
'017680',
'017364',
'016420',
'016554',
'017191',
'016426',
'016713',
'017996',
'018114',
'018030',
'018408',
'018539',
'018541',
'018676',
'018731',
'018743',
'018751',
'018925',
'019462',
'019463',
'019448',
'019583',
'019691',
'019692',
'019721',
'019735',
'019878',
'019990',
'020045',
'020100',
'020114',
'020107',
'020110',
'020085',
'020132',
'020273',
'020282',
'020215',
'020384',
'020298',
'020302',
'020462',
'020472',
'020477',
'020533',
'020545',
'020571',
'020569',
'020637',
'020665',
'020655',
'020643',
'020720',
'020696',
'020685',
'020694',
'020733',
'020727',
'020742',
'020766',
'020724',
'016664',
'017415',
'016448',
'017300',
'017547',
'017664',
'016596',
'017056',
'017663',
'017649',
'017504',
'017101',
'017654',
'017495',
'017399',
'017368',
'016490',
'016262',
'017873',
'017667',
'016886',
'016294',
'017652',
'020804',
'020786',
'020818',
'017827',
'016795',
'020739',
'020675',
'020698',
'020699',
'020723',
'020718',
'020646',
'020649',
'020656',
'020553',
'020560',
'020561',
'020567',
'020591',
'020603',
'020497',
'020514',
'020491',
'020456',
'020430',
'020425',
'020288',
'020312',
'020314',
'020315',
'020324',
'020335',
'020342',
'020372',
'020360',
'020364',
'020212',
'020261',
'020266',
'020219',
'020204',
'020191',
'020141',
'020128',
'020130',
'020124',
'020155',
'020157',
'020180',
'020181',
'020091',
'020094',
'020113',
'020096',
'020099',
'020065',
'019983',
'019979',
'016531',
'020005',
'020015',
'020016',
'019882',
'019901',
'019792',
'019771',
'019807',
'019855',
'019784',
'019708',
'019673',
'019653',
'019655',
'019638',
'017643',
'019628',
'019592',
'019604',
'016618',
'019520',
'019580',
'019540',
'019557',
'019435',
'019442',
'019502',
'019506',
'019486',
'019145',
'018930',
'019177',
'019183',
'019235',
'019249',
'019205',
'019230',
'019231',
'019273',
'019290',
'019292',
'016307',
'019352',
'019360',
'019363',
'018928',
'018938',
'018940',
'018943',
'018902',
'018906',
'018892',
'018999',
'019018',
'019021',
'019026',
'019036',
'019049',
'017661',
'019110',
'018813',
'018838',
'018833',
'018873',
'018773',
'018690',
'018692',
'018701',
'018702',
'018707',
'018724',
'018726',
'018714',
'018591',
'018605',
'018632',
'018626',
'018652',
'018671',
'018495',
'018480',
'018451',
'018556',
'018560',
'018563',
'018522',
'018524',
'018536',
'018232',
'018197',
'018199',
'018308',
'018318',
'018319',
'018281',
'018283',
'018291',
'018296',
'018343',
'018415',
'018418',
'018420',
'018407',
'018395',
'018116',
'018125',
'018141',
'018161',
'018080',
'018014',
'018017',
'017956',
'017957',
'017978',
'017980',
'017944',
'017931',
'016284',
'017822',
'016720',
'016132',
'017914',
'017682',
'017319',
'017454',
'017449',
'016610',
'016588',
'017493',
'016773',
'016087',
'017325',
'017623',
'017700',
'016354',
'017257',
'017740',
'016266',
'016492',
'017217',
'016358',
'017574',
'016339',
'017709',
'016348',
'016859',
'016640',
'016707',
'013174',
'017377',
'017135',
'017258',
'016402')
group by Cmpid