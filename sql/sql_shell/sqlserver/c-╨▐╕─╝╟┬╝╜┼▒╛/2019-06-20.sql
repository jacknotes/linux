--酒店销售单供应商来源
select profitsource,* from Topway..tbHtlcoupYf 
--update Topway..tbHtlcoupYf  set profitsource='员工垫付（王贞工行卡）'
where coupno='-PTW085062'

--匹配常旅客
select h.Name,CredentialNo from homsomDB..Trv_Human h
left join homsomDB..Trv_Credentials c on c.HumanID=h.ID
where IsDisplay=1
and CredentialNo in ('371122198710250915',
'37020519600715201X',
'330323196710174430',
'370625197310227688',
'612422197510171019',
'440508198805303911',
'452133197510080312',
'610526198604121024',
'61052619830317101X',
'412328197508099033',
'440902197502253231',
'440520196809274236',
'510228197406276277',
'362502198311050858',
'450481198410090230',
'320902196608121059',
'410105196910142798',
'430103198002044519',
'320121198707273976',
'321182198610050016',
'321102197610080438',
'440223198310214519 ',
'431223198210160612 ',
'440126197309020011',
'510321197102121277',
'430404197009212018',
'320722198710024216',
'51293019750511737X',
'321202195712083919',
'321284198806054412',
'310106198004032011',
'120101198904304011',
'321101198503144414',
'430781198002071033',
'320825198210194512',
'320921198703132037',
'440503195005080013',
'440522197401180911',
'370632197504153457',
'612401197712199210',
'120222197205190417',
'120222197210310022',
'352622196604120012',
'610113196707072138',
'441425197408010012',
'04223276',
'33090219841123291X',
'362102197612020015',
'510603198304216360',
'320681198210181615',
'320681199602064623',
'130722199310297126 ',
'220523199305090128',
'15030219900224351X',
'610629198406161935',
'371100196604080513',
'371100197306240317',
'32092219800901503X',
'513622197706063659',
'43250319850601283X',
'510107199312120011',
'430623199312056416',
'132521198202090013',
'41092219920505063X',
'452413197008190031',
'511002197710021531',
'440711197705153615',
'51028319791211841X',
'440702199003222324',
'350121197403257038',
'432502197702060010',
'420682198706294031')

select Name,Mobile from homsomDB..Trv_Human 
where IsDisplay=1
and Mobile in('13906338925',
'13708971660',
'15954651555',
'15954651555',
'18057871515',
'13428302073',
'13415076670',
'13929233490',
'13717446684',
'13926834701',
'13714598008',
'13929941888',
'13530856797',
'13724273408',
'18824836212',
'13922722577',
'13938570809',
'13318882593',
'17366239652',
'18805283555',
'13852996536',
'13686442323',
'13377715706',
'13922334983',
'13825131998',
'13600969059',
'15812444696',
'13432087666',
'15189912982',
'13611794147',
'18621588709',
'18622858930',
'15358591123',
'13929944885',
'13806239400',
'18626176534',
'13902770878',
'13353098907',
'13353080162',
'13222999805',
'18622103251',
'18622103251',
'13602659142',
'13509672595',
'13600339506',
'15858214007',
'13857102942',
'13802834475',
'13416300156',
'13522255542',
'13921490859',
'18514005969 ',
'13162500017',
'18515450345',
'15120036478',
'13336231518',
'18063388788',
'18851512737',
'18942409488',
'13380249340',
'13712367150',
'18328514952',
'15919300469',
'18688084007',
'13602767171',
'13928609858',
'13702581692',
'13709611507',
'13709611482',
'13902309974',
'13929260294',
'18938261419')


--旅游预算单作废
select Status,* from Topway..tbTravelBudget 
--update Topway..tbTravelBudget  set Status=2
where TrvId='30021'


/*2018年6月1日-2019年5月31日
国内销量
国内利润金额，
国内利润率
南航销量
南航指定舱位销量（F/J/W/Y/B/M/H/U/A/L ）
南航国内利润金额，
南航国内利润率
*/
--国内销量
if OBJECT_ID('tempdb..#gnxl') is not null drop table #gnxl
select cmpcode UC号,SUM(totprice) 国内销量,SUM(profit) 国内利润金额,SUM(profit)/SUM(totprice) 国内利润率
into #gnxl
from Topway..tbcash 
where datetime>='2018-06-01'
and datetime<'2019-06-01'
and inf=0
and cmpcode in('000037',
'002045',
'006596',
'006944',
'007638',
'009005',
'013174',
'013184',
'013909',
'014539',
'016061',
'016132',
'016213',
'016239',
'016262',
'016264',
'016266',
'016267',
'016284',
'016287',
'016289',
'016294',
'016307',
'016309',
'016310',
'016321',
'016336',
'016339',
'016344',
'016348',
'016354',
'016358',
'016362',
'016363',
'016379',
'016400',
'016414',
'016420',
'016428',
'016482',
'016492',
'016500',
'016504',
'016525',
'016532',
'016554',
'016596',
'016610',
'016617',
'016618',
'016635',
'016640',
'016646',
'016664',
'016670',
'016707',
'016713',
'016719',
'016720',
'016724',
'016773',
'016795',
'016813',
'016826',
'016848',
'016858',
'016859',
'016884',
'016886',
'016890',
'016936',
'016938',
'016961',
'016962',
'016976',
'017007',
'017016',
'017020',
'017029',
'017033',
'017055',
'017065',
'017088',
'017101',
'017122',
'017128',
'017135',
'017146',
'017150',
'017154',
'017182',
'017189',
'017191',
'017200',
'017217',
'017223',
'017257',
'017258',
'017283',
'017285',
'017286',
'017300',
'017319',
'017325',
'017326',
'017327',
'017364',
'017368',
'017377',
'017392',
'017400',
'017426',
'017429',
'017449',
'017454',
'017474',
'017480',
'017493',
'017495',
'017504',
'017505',
'017508',
'017519',
'017533',
'017543',
'017547',
'017549',
'017557',
'017559',
'017565',
'017569',
'017574',
'017577',
'017578',
'017579',
'017595',
'017622',
'017623',
'017624',
'017643',
'017652',
'017654',
'017655',
'017659',
'017661',
'017663',
'017664',
'017667',
'017680',
'017682',
'017700',
'017709',
'017740',
'017753',
'017754',
'017776',
'017786',
'017800',
'017822',
'017827',
'017851',
'017858',
'017872',
'017873',
'017886',
'017893',
'017914',
'017916',
'017919',
'017921',
'017924',
'017930',
'017931',
'017932',
'017939',
'017944',
'017954',
'017955',
'017956',
'017957',
'017978',
'017980',
'017985',
'017986',
'017989',
'018002',
'018003',
'018014',
'018017',
'018030',
'018037',
'018038',
'018042',
'018047',
'018061',
'018094',
'018103',
'018114',
'018116',
'018134',
'018141',
'018161',
'018173',
'018176',
'018193',
'018197',
'018199',
'018220',
'018232',
'018240',
'018259',
'018271',
'018278',
'018281',
'018283',
'018291',
'018296',
'018299',
'018303',
'018304',
'018308',
'018318',
'018319',
'018331',
'018341',
'018343',
'018345',
'018367',
'018382',
'018385',
'018395',
'018407',
'018408',
'018412',
'018415',
'018418',
'018419',
'018420',
'018435',
'018451',
'018463',
'018480',
'018486',
'018487',
'018490',
'018495',
'018509',
'018522',
'018524',
'018536',
'018537',
'018539',
'018541',
'018546',
'018556',
'018560',
'018563',
'018567',
'018580',
'018589',
'018605',
'018608',
'018610',
'018625',
'018626',
'018632',
'018633',
'018652',
'018669',
'018670',
'018671',
'018676',
'018690',
'018692',
'018701',
'018702',
'018707',
'018711',
'018714',
'018720',
'018724',
'018726',
'018731',
'018732',
'018743',
'018744',
'018751',
'018756',
'018758',
'018766',
'018767',
'018773',
'018790',
'018805',
'018813',
'018814',
'018816',
'018822',
'018831',
'018833',
'018834',
'018838',
'018868',
'018873',
'018882',
'018886',
'018890',
'018892',
'018896',
'018900',
'018902',
'018906',
'018910',
'018911',
'018919',
'018925',
'018926',
'018928',
'018929',
'018930',
'018937',
'018938',
'018940',
'018943',
'018945',
'018964',
'018967',
'018981',
'018989',
'018999',
'019006',
'019011',
'019018',
'019021',
'019023',
'019026',
'019036',
'019049',
'019051',
'019054',
'019072',
'019097',
'019110',
'019121',
'019145',
'019177',
'019180',
'019183',
'019189',
'019195',
'019205',
'019212',
'019216',
'019227',
'019230',
'019231',
'019234',
'019235',
'019249',
'019252',
'019258',
'019273',
'019284',
'019290',
'019292',
'019301',
'019333',
'019347',
'019348',
'019352',
'019363',
'019365',
'019366',
'019393',
'019401',
'019403',
'019411',
'019420',
'019429',
'019435',
'019442',
'019448',
'019450',
'019455',
'019461',
'019462',
'019463',
'019465',
'019475',
'019476',
'019484',
'019486',
'019497',
'019502',
'019506',
'019507',
'019520',
'019524',
'019535',
'019540',
'019568',
'019580',
'019583',
'019584',
'019587',
'019588',
'019592',
'019594',
'019603',
'019604',
'019607',
'019609',
'019628',
'019629',
'019634',
'019638',
'019640',
'019653',
'019655',
'019656',
'019658',
'019670',
'019673',
'019674',
'019679',
'019691',
'019692',
'019704',
'019708',
'019712',
'019713',
'019721',
'019727',
'019731',
'019735',
'019736',
'019737',
'019749',
'019753',
'019757',
'019760',
'019764',
'019771',
'019772',
'019774',
'019775',
'019780',
'019784',
'019786',
'019788',
'019792',
'019794',
'019802',
'019807',
'019812',
'019817',
'019827',
'019830',
'019840',
'019842',
'019843',
'019844',
'019850',
'019855',
'019863',
'019866',
'019878',
'019882',
'019884',
'019892',
'019901',
'019908',
'019919',
'019929',
'019934',
'019939',
'019941',
'019943',
'019951',
'019953',
'019958',
'019959',
'019961',
'019969',
'019970',
'019979',
'019982',
'019983',
'019988',
'019989',
'019991',
'019992',
'019998',
'020001',
'020002',
'020003',
'020005',
'020015',
'020016',
'020021',
'020022',
'020023',
'020028',
'020029',
'020033',
'020038',
'020045',
'020061',
'020062',
'020065',
'020069',
'020072',
'020085',
'020087',
'020091',
'020094',
'020095',
'020096',
'020099',
'020100',
'020106',
'020107',
'020110',
'020111',
'020112',
'020113',
'020114',
'020115',
'020118',
'020119',
'020124',
'020127',
'020128',
'020130',
'020132',
'020138',
'020141',
'020142',
'020147',
'020148',
'020149',
'020150',
'020155',
'020157',
'020161',
'020163',
'020166',
'020171',
'020173',
'020174',
'020180',
'020181',
'020184',
'020187',
'020191',
'020192',
'020195',
'020196',
'020199',
'020204',
'020207',
'020212',
'020214',
'020215',
'020218',
'020219',
'020221',
'020224',
'020228',
'020231',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020253',
'020261',
'020263',
'020264',
'020266',
'020268',
'020269',
'020272',
'020273',
'020282',
'020283',
'020286',
'020288',
'020289',
'020291',
'020293',
'020294',
'020296',
'020298',
'020302',
'020304',
'020308',
'020312',
'020314',
'020327',
'020334',
'020335',
'020338',
'020341',
'020345',
'020346',
'020349',
'020351',
'020354',
'020360',
'020364',
'020366',
'020371',
'020372',
'020384',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020416',
'020419',
'020425',
'020426',
'020430',
'020447',
'020453',
'020455',
'020456',
'020462',
'020466',
'020470',
'020472',
'020475',
'020476',
'020477',
'020483',
'020486',
'020488',
'020490',
'020491',
'020495',
'020497',
'020508',
'020510',
'020514',
'020518',
'020533',
'020536',
'020538',
'020544',
'020547',
'020548',
'020553',
'020555',
'020556',
'020560',
'020561',
'020567',
'020569',
'020570',
'020579',
'020583',
'020591',
'020594',
'020598',
'020602',
'020603',
'020617',
'020621',
'020622',
'020626',
'020629',
'020630',
'020631',
'020637',
'020639',
'020641',
'020643',
'020646',
'020649',
'020651',
'020655',
'020656',
'020664',
'020665',
'020667',
'020674',
'020675',
'020679',
'020680',
'020684',
'020685',
'020690',
'020694',
'020695',
'020696',
'020699',
'020701',
'020709',
'020718',
'020720',
'020726',
'020727',
'020729',
'020733',
'020734',
'020737',
'020739',
'020742',
'020747',
'020753',
'020756',
'020758',
'020761',
'020763',
'020766',
'020771',
'020774',
'020777',
'020784',
'020786',
'020799',
'020801',
'020803',
'020804',
'020805',
'020812',
'020817',
'020818',
'020820')
group by cmpcode

--南航销量
if OBJECT_ID('tempdb..#nhxl') is not null drop table #nhxl
select cmpcode UC号,SUM(totprice)南航销量 
into #nhxl
from Topway..tbcash 
where datetime>='2018-06-01'
and datetime<'2019-06-01'
and ride='cz'
and cmpcode in ('000037',
'002045',
'006596',
'006944',
'007638',
'009005',
'013174',
'013184',
'013909',
'014539',
'016061',
'016132',
'016213',
'016239',
'016262',
'016264',
'016266',
'016267',
'016284',
'016287',
'016289',
'016294',
'016307',
'016309',
'016310',
'016321',
'016336',
'016339',
'016344',
'016348',
'016354',
'016358',
'016362',
'016363',
'016379',
'016400',
'016414',
'016420',
'016428',
'016482',
'016492',
'016500',
'016504',
'016525',
'016532',
'016554',
'016596',
'016610',
'016617',
'016618',
'016635',
'016640',
'016646',
'016664',
'016670',
'016707',
'016713',
'016719',
'016720',
'016724',
'016773',
'016795',
'016813',
'016826',
'016848',
'016858',
'016859',
'016884',
'016886',
'016890',
'016936',
'016938',
'016961',
'016962',
'016976',
'017007',
'017016',
'017020',
'017029',
'017033',
'017055',
'017065',
'017088',
'017101',
'017122',
'017128',
'017135',
'017146',
'017150',
'017154',
'017182',
'017189',
'017191',
'017200',
'017217',
'017223',
'017257',
'017258',
'017283',
'017285',
'017286',
'017300',
'017319',
'017325',
'017326',
'017327',
'017364',
'017368',
'017377',
'017392',
'017400',
'017426',
'017429',
'017449',
'017454',
'017474',
'017480',
'017493',
'017495',
'017504',
'017505',
'017508',
'017519',
'017533',
'017543',
'017547',
'017549',
'017557',
'017559',
'017565',
'017569',
'017574',
'017577',
'017578',
'017579',
'017595',
'017622',
'017623',
'017624',
'017643',
'017652',
'017654',
'017655',
'017659',
'017661',
'017663',
'017664',
'017667',
'017680',
'017682',
'017700',
'017709',
'017740',
'017753',
'017754',
'017776',
'017786',
'017800',
'017822',
'017827',
'017851',
'017858',
'017872',
'017873',
'017886',
'017893',
'017914',
'017916',
'017919',
'017921',
'017924',
'017930',
'017931',
'017932',
'017939',
'017944',
'017954',
'017955',
'017956',
'017957',
'017978',
'017980',
'017985',
'017986',
'017989',
'018002',
'018003',
'018014',
'018017',
'018030',
'018037',
'018038',
'018042',
'018047',
'018061',
'018094',
'018103',
'018114',
'018116',
'018134',
'018141',
'018161',
'018173',
'018176',
'018193',
'018197',
'018199',
'018220',
'018232',
'018240',
'018259',
'018271',
'018278',
'018281',
'018283',
'018291',
'018296',
'018299',
'018303',
'018304',
'018308',
'018318',
'018319',
'018331',
'018341',
'018343',
'018345',
'018367',
'018382',
'018385',
'018395',
'018407',
'018408',
'018412',
'018415',
'018418',
'018419',
'018420',
'018435',
'018451',
'018463',
'018480',
'018486',
'018487',
'018490',
'018495',
'018509',
'018522',
'018524',
'018536',
'018537',
'018539',
'018541',
'018546',
'018556',
'018560',
'018563',
'018567',
'018580',
'018589',
'018605',
'018608',
'018610',
'018625',
'018626',
'018632',
'018633',
'018652',
'018669',
'018670',
'018671',
'018676',
'018690',
'018692',
'018701',
'018702',
'018707',
'018711',
'018714',
'018720',
'018724',
'018726',
'018731',
'018732',
'018743',
'018744',
'018751',
'018756',
'018758',
'018766',
'018767',
'018773',
'018790',
'018805',
'018813',
'018814',
'018816',
'018822',
'018831',
'018833',
'018834',
'018838',
'018868',
'018873',
'018882',
'018886',
'018890',
'018892',
'018896',
'018900',
'018902',
'018906',
'018910',
'018911',
'018919',
'018925',
'018926',
'018928',
'018929',
'018930',
'018937',
'018938',
'018940',
'018943',
'018945',
'018964',
'018967',
'018981',
'018989',
'018999',
'019006',
'019011',
'019018',
'019021',
'019023',
'019026',
'019036',
'019049',
'019051',
'019054',
'019072',
'019097',
'019110',
'019121',
'019145',
'019177',
'019180',
'019183',
'019189',
'019195',
'019205',
'019212',
'019216',
'019227',
'019230',
'019231',
'019234',
'019235',
'019249',
'019252',
'019258',
'019273',
'019284',
'019290',
'019292',
'019301',
'019333',
'019347',
'019348',
'019352',
'019363',
'019365',
'019366',
'019393',
'019401',
'019403',
'019411',
'019420',
'019429',
'019435',
'019442',
'019448',
'019450',
'019455',
'019461',
'019462',
'019463',
'019465',
'019475',
'019476',
'019484',
'019486',
'019497',
'019502',
'019506',
'019507',
'019520',
'019524',
'019535',
'019540',
'019568',
'019580',
'019583',
'019584',
'019587',
'019588',
'019592',
'019594',
'019603',
'019604',
'019607',
'019609',
'019628',
'019629',
'019634',
'019638',
'019640',
'019653',
'019655',
'019656',
'019658',
'019670',
'019673',
'019674',
'019679',
'019691',
'019692',
'019704',
'019708',
'019712',
'019713',
'019721',
'019727',
'019731',
'019735',
'019736',
'019737',
'019749',
'019753',
'019757',
'019760',
'019764',
'019771',
'019772',
'019774',
'019775',
'019780',
'019784',
'019786',
'019788',
'019792',
'019794',
'019802',
'019807',
'019812',
'019817',
'019827',
'019830',
'019840',
'019842',
'019843',
'019844',
'019850',
'019855',
'019863',
'019866',
'019878',
'019882',
'019884',
'019892',
'019901',
'019908',
'019919',
'019929',
'019934',
'019939',
'019941',
'019943',
'019951',
'019953',
'019958',
'019959',
'019961',
'019969',
'019970',
'019979',
'019982',
'019983',
'019988',
'019989',
'019991',
'019992',
'019998',
'020001',
'020002',
'020003',
'020005',
'020015',
'020016',
'020021',
'020022',
'020023',
'020028',
'020029',
'020033',
'020038',
'020045',
'020061',
'020062',
'020065',
'020069',
'020072',
'020085',
'020087',
'020091',
'020094',
'020095',
'020096',
'020099',
'020100',
'020106',
'020107',
'020110',
'020111',
'020112',
'020113',
'020114',
'020115',
'020118',
'020119',
'020124',
'020127',
'020128',
'020130',
'020132',
'020138',
'020141',
'020142',
'020147',
'020148',
'020149',
'020150',
'020155',
'020157',
'020161',
'020163',
'020166',
'020171',
'020173',
'020174',
'020180',
'020181',
'020184',
'020187',
'020191',
'020192',
'020195',
'020196',
'020199',
'020204',
'020207',
'020212',
'020214',
'020215',
'020218',
'020219',
'020221',
'020224',
'020228',
'020231',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020253',
'020261',
'020263',
'020264',
'020266',
'020268',
'020269',
'020272',
'020273',
'020282',
'020283',
'020286',
'020288',
'020289',
'020291',
'020293',
'020294',
'020296',
'020298',
'020302',
'020304',
'020308',
'020312',
'020314',
'020327',
'020334',
'020335',
'020338',
'020341',
'020345',
'020346',
'020349',
'020351',
'020354',
'020360',
'020364',
'020366',
'020371',
'020372',
'020384',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020416',
'020419',
'020425',
'020426',
'020430',
'020447',
'020453',
'020455',
'020456',
'020462',
'020466',
'020470',
'020472',
'020475',
'020476',
'020477',
'020483',
'020486',
'020488',
'020490',
'020491',
'020495',
'020497',
'020508',
'020510',
'020514',
'020518',
'020533',
'020536',
'020538',
'020544',
'020547',
'020548',
'020553',
'020555',
'020556',
'020560',
'020561',
'020567',
'020569',
'020570',
'020579',
'020583',
'020591',
'020594',
'020598',
'020602',
'020603',
'020617',
'020621',
'020622',
'020626',
'020629',
'020630',
'020631',
'020637',
'020639',
'020641',
'020643',
'020646',
'020649',
'020651',
'020655',
'020656',
'020664',
'020665',
'020667',
'020674',
'020675',
'020679',
'020680',
'020684',
'020685',
'020690',
'020694',
'020695',
'020696',
'020699',
'020701',
'020709',
'020718',
'020720',
'020726',
'020727',
'020729',
'020733',
'020734',
'020737',
'020739',
'020742',
'020747',
'020753',
'020756',
'020758',
'020761',
'020763',
'020766',
'020771',
'020774',
'020777',
'020784',
'020786',
'020799',
'020801',
'020803',
'020804',
'020805',
'020812',
'020817',
'020818',
'020820')
group by cmpcode


--南航指定舱位销量（F/J/W/Y/B/M/H/U/A/L ）
if OBJECT_ID('tempdb..#nhcw') is not null drop table #nhcw
select cmpcode UC号,SUM(totprice)南航指定舱位销量 
into #nhcw
from Topway..tbcash 
where datetime>='2018-06-01'
and datetime<'2019-06-01'
and ride='cz'
and nclass in ('F','J','W','Y','B','M','H','U','A','L')
and cmpcode in ('000037',
'002045',
'006596',
'006944',
'007638',
'009005',
'013174',
'013184',
'013909',
'014539',
'016061',
'016132',
'016213',
'016239',
'016262',
'016264',
'016266',
'016267',
'016284',
'016287',
'016289',
'016294',
'016307',
'016309',
'016310',
'016321',
'016336',
'016339',
'016344',
'016348',
'016354',
'016358',
'016362',
'016363',
'016379',
'016400',
'016414',
'016420',
'016428',
'016482',
'016492',
'016500',
'016504',
'016525',
'016532',
'016554',
'016596',
'016610',
'016617',
'016618',
'016635',
'016640',
'016646',
'016664',
'016670',
'016707',
'016713',
'016719',
'016720',
'016724',
'016773',
'016795',
'016813',
'016826',
'016848',
'016858',
'016859',
'016884',
'016886',
'016890',
'016936',
'016938',
'016961',
'016962',
'016976',
'017007',
'017016',
'017020',
'017029',
'017033',
'017055',
'017065',
'017088',
'017101',
'017122',
'017128',
'017135',
'017146',
'017150',
'017154',
'017182',
'017189',
'017191',
'017200',
'017217',
'017223',
'017257',
'017258',
'017283',
'017285',
'017286',
'017300',
'017319',
'017325',
'017326',
'017327',
'017364',
'017368',
'017377',
'017392',
'017400',
'017426',
'017429',
'017449',
'017454',
'017474',
'017480',
'017493',
'017495',
'017504',
'017505',
'017508',
'017519',
'017533',
'017543',
'017547',
'017549',
'017557',
'017559',
'017565',
'017569',
'017574',
'017577',
'017578',
'017579',
'017595',
'017622',
'017623',
'017624',
'017643',
'017652',
'017654',
'017655',
'017659',
'017661',
'017663',
'017664',
'017667',
'017680',
'017682',
'017700',
'017709',
'017740',
'017753',
'017754',
'017776',
'017786',
'017800',
'017822',
'017827',
'017851',
'017858',
'017872',
'017873',
'017886',
'017893',
'017914',
'017916',
'017919',
'017921',
'017924',
'017930',
'017931',
'017932',
'017939',
'017944',
'017954',
'017955',
'017956',
'017957',
'017978',
'017980',
'017985',
'017986',
'017989',
'018002',
'018003',
'018014',
'018017',
'018030',
'018037',
'018038',
'018042',
'018047',
'018061',
'018094',
'018103',
'018114',
'018116',
'018134',
'018141',
'018161',
'018173',
'018176',
'018193',
'018197',
'018199',
'018220',
'018232',
'018240',
'018259',
'018271',
'018278',
'018281',
'018283',
'018291',
'018296',
'018299',
'018303',
'018304',
'018308',
'018318',
'018319',
'018331',
'018341',
'018343',
'018345',
'018367',
'018382',
'018385',
'018395',
'018407',
'018408',
'018412',
'018415',
'018418',
'018419',
'018420',
'018435',
'018451',
'018463',
'018480',
'018486',
'018487',
'018490',
'018495',
'018509',
'018522',
'018524',
'018536',
'018537',
'018539',
'018541',
'018546',
'018556',
'018560',
'018563',
'018567',
'018580',
'018589',
'018605',
'018608',
'018610',
'018625',
'018626',
'018632',
'018633',
'018652',
'018669',
'018670',
'018671',
'018676',
'018690',
'018692',
'018701',
'018702',
'018707',
'018711',
'018714',
'018720',
'018724',
'018726',
'018731',
'018732',
'018743',
'018744',
'018751',
'018756',
'018758',
'018766',
'018767',
'018773',
'018790',
'018805',
'018813',
'018814',
'018816',
'018822',
'018831',
'018833',
'018834',
'018838',
'018868',
'018873',
'018882',
'018886',
'018890',
'018892',
'018896',
'018900',
'018902',
'018906',
'018910',
'018911',
'018919',
'018925',
'018926',
'018928',
'018929',
'018930',
'018937',
'018938',
'018940',
'018943',
'018945',
'018964',
'018967',
'018981',
'018989',
'018999',
'019006',
'019011',
'019018',
'019021',
'019023',
'019026',
'019036',
'019049',
'019051',
'019054',
'019072',
'019097',
'019110',
'019121',
'019145',
'019177',
'019180',
'019183',
'019189',
'019195',
'019205',
'019212',
'019216',
'019227',
'019230',
'019231',
'019234',
'019235',
'019249',
'019252',
'019258',
'019273',
'019284',
'019290',
'019292',
'019301',
'019333',
'019347',
'019348',
'019352',
'019363',
'019365',
'019366',
'019393',
'019401',
'019403',
'019411',
'019420',
'019429',
'019435',
'019442',
'019448',
'019450',
'019455',
'019461',
'019462',
'019463',
'019465',
'019475',
'019476',
'019484',
'019486',
'019497',
'019502',
'019506',
'019507',
'019520',
'019524',
'019535',
'019540',
'019568',
'019580',
'019583',
'019584',
'019587',
'019588',
'019592',
'019594',
'019603',
'019604',
'019607',
'019609',
'019628',
'019629',
'019634',
'019638',
'019640',
'019653',
'019655',
'019656',
'019658',
'019670',
'019673',
'019674',
'019679',
'019691',
'019692',
'019704',
'019708',
'019712',
'019713',
'019721',
'019727',
'019731',
'019735',
'019736',
'019737',
'019749',
'019753',
'019757',
'019760',
'019764',
'019771',
'019772',
'019774',
'019775',
'019780',
'019784',
'019786',
'019788',
'019792',
'019794',
'019802',
'019807',
'019812',
'019817',
'019827',
'019830',
'019840',
'019842',
'019843',
'019844',
'019850',
'019855',
'019863',
'019866',
'019878',
'019882',
'019884',
'019892',
'019901',
'019908',
'019919',
'019929',
'019934',
'019939',
'019941',
'019943',
'019951',
'019953',
'019958',
'019959',
'019961',
'019969',
'019970',
'019979',
'019982',
'019983',
'019988',
'019989',
'019991',
'019992',
'019998',
'020001',
'020002',
'020003',
'020005',
'020015',
'020016',
'020021',
'020022',
'020023',
'020028',
'020029',
'020033',
'020038',
'020045',
'020061',
'020062',
'020065',
'020069',
'020072',
'020085',
'020087',
'020091',
'020094',
'020095',
'020096',
'020099',
'020100',
'020106',
'020107',
'020110',
'020111',
'020112',
'020113',
'020114',
'020115',
'020118',
'020119',
'020124',
'020127',
'020128',
'020130',
'020132',
'020138',
'020141',
'020142',
'020147',
'020148',
'020149',
'020150',
'020155',
'020157',
'020161',
'020163',
'020166',
'020171',
'020173',
'020174',
'020180',
'020181',
'020184',
'020187',
'020191',
'020192',
'020195',
'020196',
'020199',
'020204',
'020207',
'020212',
'020214',
'020215',
'020218',
'020219',
'020221',
'020224',
'020228',
'020231',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020253',
'020261',
'020263',
'020264',
'020266',
'020268',
'020269',
'020272',
'020273',
'020282',
'020283',
'020286',
'020288',
'020289',
'020291',
'020293',
'020294',
'020296',
'020298',
'020302',
'020304',
'020308',
'020312',
'020314',
'020327',
'020334',
'020335',
'020338',
'020341',
'020345',
'020346',
'020349',
'020351',
'020354',
'020360',
'020364',
'020366',
'020371',
'020372',
'020384',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020416',
'020419',
'020425',
'020426',
'020430',
'020447',
'020453',
'020455',
'020456',
'020462',
'020466',
'020470',
'020472',
'020475',
'020476',
'020477',
'020483',
'020486',
'020488',
'020490',
'020491',
'020495',
'020497',
'020508',
'020510',
'020514',
'020518',
'020533',
'020536',
'020538',
'020544',
'020547',
'020548',
'020553',
'020555',
'020556',
'020560',
'020561',
'020567',
'020569',
'020570',
'020579',
'020583',
'020591',
'020594',
'020598',
'020602',
'020603',
'020617',
'020621',
'020622',
'020626',
'020629',
'020630',
'020631',
'020637',
'020639',
'020641',
'020643',
'020646',
'020649',
'020651',
'020655',
'020656',
'020664',
'020665',
'020667',
'020674',
'020675',
'020679',
'020680',
'020684',
'020685',
'020690',
'020694',
'020695',
'020696',
'020699',
'020701',
'020709',
'020718',
'020720',
'020726',
'020727',
'020729',
'020733',
'020734',
'020737',
'020739',
'020742',
'020747',
'020753',
'020756',
'020758',
'020761',
'020763',
'020766',
'020771',
'020774',
'020777',
'020784',
'020786',
'020799',
'020801',
'020803',
'020804',
'020805',
'020812',
'020817',
'020818',
'020820')
group by cmpcode

--南航国内
if OBJECT_ID('tempdb..#nhgn') is not null drop table #nhgn
select cmpcode UC号,SUM(profit) 南航国内利润金额,SUM(profit)/SUM(totprice) 南航国内利润率 
into #nhgn
from Topway..tbcash 
where datetime>='2018-06-01'
and datetime<'2019-06-01'
and inf=0
and ride='cz'
and cmpcode in ('000037',
'002045',
'006596',
'006944',
'007638',
'009005',
'013174',
'013184',
'013909',
'014539',
'016061',
'016132',
'016213',
'016239',
'016262',
'016264',
'016266',
'016267',
'016284',
'016287',
'016289',
'016294',
'016307',
'016309',
'016310',
'016321',
'016336',
'016339',
'016344',
'016348',
'016354',
'016358',
'016362',
'016363',
'016379',
'016400',
'016414',
'016420',
'016428',
'016482',
'016492',
'016500',
'016504',
'016525',
'016532',
'016554',
'016596',
'016610',
'016617',
'016618',
'016635',
'016640',
'016646',
'016664',
'016670',
'016707',
'016713',
'016719',
'016720',
'016724',
'016773',
'016795',
'016813',
'016826',
'016848',
'016858',
'016859',
'016884',
'016886',
'016890',
'016936',
'016938',
'016961',
'016962',
'016976',
'017007',
'017016',
'017020',
'017029',
'017033',
'017055',
'017065',
'017088',
'017101',
'017122',
'017128',
'017135',
'017146',
'017150',
'017154',
'017182',
'017189',
'017191',
'017200',
'017217',
'017223',
'017257',
'017258',
'017283',
'017285',
'017286',
'017300',
'017319',
'017325',
'017326',
'017327',
'017364',
'017368',
'017377',
'017392',
'017400',
'017426',
'017429',
'017449',
'017454',
'017474',
'017480',
'017493',
'017495',
'017504',
'017505',
'017508',
'017519',
'017533',
'017543',
'017547',
'017549',
'017557',
'017559',
'017565',
'017569',
'017574',
'017577',
'017578',
'017579',
'017595',
'017622',
'017623',
'017624',
'017643',
'017652',
'017654',
'017655',
'017659',
'017661',
'017663',
'017664',
'017667',
'017680',
'017682',
'017700',
'017709',
'017740',
'017753',
'017754',
'017776',
'017786',
'017800',
'017822',
'017827',
'017851',
'017858',
'017872',
'017873',
'017886',
'017893',
'017914',
'017916',
'017919',
'017921',
'017924',
'017930',
'017931',
'017932',
'017939',
'017944',
'017954',
'017955',
'017956',
'017957',
'017978',
'017980',
'017985',
'017986',
'017989',
'018002',
'018003',
'018014',
'018017',
'018030',
'018037',
'018038',
'018042',
'018047',
'018061',
'018094',
'018103',
'018114',
'018116',
'018134',
'018141',
'018161',
'018173',
'018176',
'018193',
'018197',
'018199',
'018220',
'018232',
'018240',
'018259',
'018271',
'018278',
'018281',
'018283',
'018291',
'018296',
'018299',
'018303',
'018304',
'018308',
'018318',
'018319',
'018331',
'018341',
'018343',
'018345',
'018367',
'018382',
'018385',
'018395',
'018407',
'018408',
'018412',
'018415',
'018418',
'018419',
'018420',
'018435',
'018451',
'018463',
'018480',
'018486',
'018487',
'018490',
'018495',
'018509',
'018522',
'018524',
'018536',
'018537',
'018539',
'018541',
'018546',
'018556',
'018560',
'018563',
'018567',
'018580',
'018589',
'018605',
'018608',
'018610',
'018625',
'018626',
'018632',
'018633',
'018652',
'018669',
'018670',
'018671',
'018676',
'018690',
'018692',
'018701',
'018702',
'018707',
'018711',
'018714',
'018720',
'018724',
'018726',
'018731',
'018732',
'018743',
'018744',
'018751',
'018756',
'018758',
'018766',
'018767',
'018773',
'018790',
'018805',
'018813',
'018814',
'018816',
'018822',
'018831',
'018833',
'018834',
'018838',
'018868',
'018873',
'018882',
'018886',
'018890',
'018892',
'018896',
'018900',
'018902',
'018906',
'018910',
'018911',
'018919',
'018925',
'018926',
'018928',
'018929',
'018930',
'018937',
'018938',
'018940',
'018943',
'018945',
'018964',
'018967',
'018981',
'018989',
'018999',
'019006',
'019011',
'019018',
'019021',
'019023',
'019026',
'019036',
'019049',
'019051',
'019054',
'019072',
'019097',
'019110',
'019121',
'019145',
'019177',
'019180',
'019183',
'019189',
'019195',
'019205',
'019212',
'019216',
'019227',
'019230',
'019231',
'019234',
'019235',
'019249',
'019252',
'019258',
'019273',
'019284',
'019290',
'019292',
'019301',
'019333',
'019347',
'019348',
'019352',
'019363',
'019365',
'019366',
'019393',
'019401',
'019403',
'019411',
'019420',
'019429',
'019435',
'019442',
'019448',
'019450',
'019455',
'019461',
'019462',
'019463',
'019465',
'019475',
'019476',
'019484',
'019486',
'019497',
'019502',
'019506',
'019507',
'019520',
'019524',
'019535',
'019540',
'019568',
'019580',
'019583',
'019584',
'019587',
'019588',
'019592',
'019594',
'019603',
'019604',
'019607',
'019609',
'019628',
'019629',
'019634',
'019638',
'019640',
'019653',
'019655',
'019656',
'019658',
'019670',
'019673',
'019674',
'019679',
'019691',
'019692',
'019704',
'019708',
'019712',
'019713',
'019721',
'019727',
'019731',
'019735',
'019736',
'019737',
'019749',
'019753',
'019757',
'019760',
'019764',
'019771',
'019772',
'019774',
'019775',
'019780',
'019784',
'019786',
'019788',
'019792',
'019794',
'019802',
'019807',
'019812',
'019817',
'019827',
'019830',
'019840',
'019842',
'019843',
'019844',
'019850',
'019855',
'019863',
'019866',
'019878',
'019882',
'019884',
'019892',
'019901',
'019908',
'019919',
'019929',
'019934',
'019939',
'019941',
'019943',
'019951',
'019953',
'019958',
'019959',
'019961',
'019969',
'019970',
'019979',
'019982',
'019983',
'019988',
'019989',
'019991',
'019992',
'019998',
'020001',
'020002',
'020003',
'020005',
'020015',
'020016',
'020021',
'020022',
'020023',
'020028',
'020029',
'020033',
'020038',
'020045',
'020061',
'020062',
'020065',
'020069',
'020072',
'020085',
'020087',
'020091',
'020094',
'020095',
'020096',
'020099',
'020100',
'020106',
'020107',
'020110',
'020111',
'020112',
'020113',
'020114',
'020115',
'020118',
'020119',
'020124',
'020127',
'020128',
'020130',
'020132',
'020138',
'020141',
'020142',
'020147',
'020148',
'020149',
'020150',
'020155',
'020157',
'020161',
'020163',
'020166',
'020171',
'020173',
'020174',
'020180',
'020181',
'020184',
'020187',
'020191',
'020192',
'020195',
'020196',
'020199',
'020204',
'020207',
'020212',
'020214',
'020215',
'020218',
'020219',
'020221',
'020224',
'020228',
'020231',
'020234',
'020235',
'020237',
'020238',
'020241',
'020243',
'020245',
'020253',
'020261',
'020263',
'020264',
'020266',
'020268',
'020269',
'020272',
'020273',
'020282',
'020283',
'020286',
'020288',
'020289',
'020291',
'020293',
'020294',
'020296',
'020298',
'020302',
'020304',
'020308',
'020312',
'020314',
'020327',
'020334',
'020335',
'020338',
'020341',
'020345',
'020346',
'020349',
'020351',
'020354',
'020360',
'020364',
'020366',
'020371',
'020372',
'020384',
'020387',
'020396',
'020401',
'020403',
'020405',
'020413',
'020416',
'020419',
'020425',
'020426',
'020430',
'020447',
'020453',
'020455',
'020456',
'020462',
'020466',
'020470',
'020472',
'020475',
'020476',
'020477',
'020483',
'020486',
'020488',
'020490',
'020491',
'020495',
'020497',
'020508',
'020510',
'020514',
'020518',
'020533',
'020536',
'020538',
'020544',
'020547',
'020548',
'020553',
'020555',
'020556',
'020560',
'020561',
'020567',
'020569',
'020570',
'020579',
'020583',
'020591',
'020594',
'020598',
'020602',
'020603',
'020617',
'020621',
'020622',
'020626',
'020629',
'020630',
'020631',
'020637',
'020639',
'020641',
'020643',
'020646',
'020649',
'020651',
'020655',
'020656',
'020664',
'020665',
'020667',
'020674',
'020675',
'020679',
'020680',
'020684',
'020685',
'020690',
'020694',
'020695',
'020696',
'020699',
'020701',
'020709',
'020718',
'020720',
'020726',
'020727',
'020729',
'020733',
'020734',
'020737',
'020739',
'020742',
'020747',
'020753',
'020756',
'020758',
'020761',
'020763',
'020766',
'020771',
'020774',
'020777',
'020784',
'020786',
'020799',
'020801',
'020803',
'020804',
'020805',
'020812',
'020817',
'020818',
'020820')
group by cmpcode

select g.UC号,国内销量,国内利润金额,国内利润率,isnull(南航销量,0)南航销量,isnull(南航指定舱位销量,0)南航指定舱位销量,
isnull(南航国内利润金额,0)南航国内利润金额,isnull(南航国内利润率,0)南航国内利润率
from #gnxl g
left join #nhxl x on x.UC号=g.UC号 
left join #nhcw n on n.UC号=g.UC号
left join #nhgn h on h.UC号=g.UC号

--结算价差额
select totsprice,profit,* from Topway..tbcash 
--update Topway..tbcash  set totsprice=totsprice+1,profit=profit-1
where coupno in('AS002564727','AS002565617','AS002566024','AS002567644','AS002567639')

--修改UC号（酒店）
--select * from Topway..AccountStatement where CompanyCode='020663'
--select NewModifyBillNumber,custid,Pform,custinfo,spersoninfo,* from Topway..tbHtlcoupYf where OriginalBillNumber='020663_20190601'

select cmpid,OriginalBillNumber,NewModifyBillNumber,custid,pform,custinfo,spersoninfo,* from Topway..tbHtlcoupYf
--update Topway..tbHtlcoupYf set cmpid='020663',OriginalBillNumber='020663_20190601',NewModifyBillNumber='019486_20180801',custid='D634048',pform='贷记',custinfo='上海识装信息科技有限公司|游晨礼|18001963249|18001963249',spersoninfo='游晨礼|18001963249||' 
where coupno in ('PTW085046')

--账单撤销
select SubmitState,* from Topway..AccountStatement 
--update Topway..AccountStatement  set SubmitState=1
where BillNumber='020272_20190501'

select SubmitState,* from Topway..AccountStatement 
--update Topway..AccountStatement  set SubmitState=1
where BillNumber='019974_20190501'


--退票状态
select status2,* from Topway..tbReti 
--update Topway..tbReti set status2=7
where reno='9264581'

select totprice,* from Topway..tbFiveCoupInfo where CoupNo='AS002537876'
select totprice,amount,* from Topway..tbcash where coupno='AS002537876'

if OBJECT_ID('tempdb..#cp') is not null drop table #cp
select coupno,SUM(totprice)销量 
into #cp
from Topway..tbcash 
where pform='现结'
and inf=1
and datetime>='2019-01-01'
group by coupno


select  c.coupno,销量,SUM(t.totprice)实际销量
from #cp c
left join Topway..tbFiveCoupInfo t on t.CoupNo=c.coupno
group by c.coupno,销量
having 销量<>SUM(t.totprice)


select * from ApproveBase..App_Content where Value like '%AS002311423%'

--会务预算单信息
select Sales,OperName,* from Topway..tbConventionBudget
--update Topway..tbConventionBudget set Sales='崔之阳',OperName='0481崔之阳'
where ConventionId in('1251','1173','1325','1231','1226','1275','1205','1387','1389','1149',
'1204','1147','1110','1157','1379','1172','1367',
'1300','1161','1248','1241','1343','1154','969','792',
'791','1394','1391','1389','1387','1379','1376','1375','1367','1360','1343',
'1325','1324','1300','1299','1273','1259','1258','1251','1248','1241','1231',
'1226','1225','1224','1221','1205','1204','1182','1173','1172','1168','1161',
'1157','1154','1149','1148','1147','1115','1110','1099')

--酒店销售单供应商来源
select profitsource,* from Topway..tbHtlcoupYf 
--update Topway..tbHtlcoupYf  set profitsource='携程官网分销联盟'
where CoupNo='PTW085087'

--酒店销售单重开打印权限
select pstatus,prdate,* from Topway..tbHtlcoupYf 
--update Topway..tbHtlcoupYf  set pstatus=0,prdate='1900-01-01'
where CoupNo='PTW083765'

--账单撤销
select SubmitState,* from Topway..AccountStatement 
--update Topway..AccountStatement  set SubmitState=1
where BillNumber='020084_20190501'

--修改UC号（机票）
--select * from Topway..AccountStatement where CompanyCode='019331'
--select * from Topway..tbcash where cmpcode='019331' and OriginalBillNumber='019331_20190601'

select cmpcode,OriginalBillNumber,ModifyBillNumber,custid,pform,* from Topway..tbcash 
--update Topway..tbcash  set cmpcode='019331',OriginalBillNumber='019331_20190601',custid='D611831',pform='月结(中行)'
where coupno='AS002564168'
