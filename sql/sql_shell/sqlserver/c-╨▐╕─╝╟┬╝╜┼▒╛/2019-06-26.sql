/*
a 2018年1月1日-2019年6月26日出过国内机票的常旅客名单数字，
b 终止合作的客户以及合作状态为正常合作仅限现结的客户
*/
--出票证件号
if OBJECT_ID ('tempdb..#cp') is not null drop table #cp
select distinct cmpcode,idno 
into #cp
from Topway..tbcash 
where datetime>='2018-01-01'
and inf=0
and reti=''
and cmpcode in ('018919',
'020029',
'018589',
'017020',
'016428',
'019507')

select cmpcode,COUNT(1) 数量  from #cp
group by cmpcode


select Cmpid,(CASE CooperativeStatus WHEN 0 THEN '我方终止合作' WHEN 1 THEN '正常合作正常月结' WHEN 2 THEN '正常合作仅限现结' WHEN 3 THEN '正常合作临时月结' WHEN 4 THEN '对方终止合作'  ELSE '' END) as 合作状态
from homsomDB..Trv_UnitCompanies 
where Cmpid in ('017595',
'019653',
'019959',
'018463',
'018030',
'017955',
'020100',
'016336',
'019708',
'017327',
'019401',
'017659',
'017753',
'016414',
'018331',
'019772',
'019177',
'019588',
'019807',
'017505',
'016646',
'018896',
'020631',
'020345',
'018900',
'020096',
'020099',
'020308',
'020114',
'017508',
'016264',
'018002',
'016482',
'017547',
'019878',
'017364',
'018487',
'019830',
'020091',
'018756',
'018928',
'019205',
'018732',
'016720',
'020286',
'019497',
'020560',
'016266',
'019054',
'019892',
'016554',
'019802',
'016938',
'019840',
'018589',
'019051',
'019850',
'018304',
'018193',
'019691',
'018014',
'019753',
'018813',
'020231',
'018833',
'016962',
'019934',
'018726',
'020561',
'020171',
'020646',
'020544',
'020163',
'020456',
'017654',
'020667',
'017325',
'019189',
'020149',
'020396',
'020777',
'019023',
'019249',
'017150',
'018042',
'018967',
'019442',
'019958',
'019774',
'019704',
'020166',
'017682',
'018536',
'019450',
'019792',
'018669',
'020141',
'019365',
'019258',
'000037',
'020005',
'019411',
'019230',
'017495',
'017664',
'019568',
'019736',
'019465',
'018047',
'018767',
'019970',
'020219',
'018758',
'020425',
'016886',
'013909',
'018509',
'006944',
'019292',
'019476',
'020003',
'018037',
'019674',
'019195',
'019844',
'020426',
'020622',
'017740',
'020023',
'018910',
'019988',
'017033',
'019991',
'017700',
'020065',
'019692',
'020291',
'018834',
'018173',
'020495',
'020726',
'018720',
'018670',
'019989',
'020106',
'020184',
'018490',
'019535',
'016724',
'017986',
'019231',
'017182',
'018790',
'019713',
'020820',
'018711',
'019506',
'020555',
'020799',
'018608',
'020569',
'020477',
'020488',
'018318',
'016813',
'020416',
'018626',
'019721',
'018240',
'016307',
'018176',
'017543',
'019941',
'018814',
'016061',
'019939',
'019121',
'018003',
'020758',
'020021',
'018930',
'018766',
'020674',
'018303',
'020651',
'018199',
'018926',
'020161',
'019475',
'019863',
'020263',
'017655',
'017200',
'017449',
'020351',
'020784',
'017916',
'020341',
'019110',
'020701',
'017954',
'018671',
'020419',
'020338',
'018134',
'020727',
'018420',
'019455',
'020602',
'020215',
'019658',
'020180',
'020095',
'020094',
'019673',
'019817',
'016848',
'017480',
'020119',
'019592',
'020087',
'019634',
'016348',
'020253',
'020695',
'016961',
'020235',
'019363',
'017939',
'020069',
'019764',
'016719',
'016310',
'017519',
'020771',
'020349',
'019827',
'018945',
'017858',
'020476',
'017622',
'018385',
'020234',
'018731',
'019640',
'017286',
'019882',
'014539',
'020387',
'017851',
'016321',
'017873',
'017029',
'020486',
'019961',
'020729',
'016504',
'017989',
'019656',
'020734',
'019484',
'018278',
'018299',
'019006',
'020155',
'016936',
'020157',
'018419',
'018435',
'019348',
'018625',
'016492',
'020288',
'019780',
'019638',
'018805',
'018744',
'018940',
'018831',
'018882',
'018890',
'020679',
'018345',
'020462',
'020690',
'020148',
'018522',
'019021',
'020641',
'018341',
'018094',
'017223',
'018822',
'017930',
'017932',
'017776',
'020147',
'020384',
'020243',
'018981',
'013184',
'018868',
'020763',
'017886',
'018343',
'019919',
'020709',
'018259',
'020072',
'002045',
'020466',
'016239',
'020626',
'018929',
'017055',
'019866',
'017007',
'017921',
'020603',
'019670',
'016890',
'019901',
'017326',
'020132',
'019953',
'020228',
'020675',
'020684',
'019998',
'017146',
'020733',
'016294',
'020191',
'016635',
'019794',
'017559',
'020718',
'018281',
'018061',
'020536',
'020761',
'020293',
'020142',
'019842',
'017919',
'018925',
'019227',
'019347',
'020801',
'020805',
'020812',
'019403',
'019609',
'019951',
'020033',
'020510')


select  * from Topway..tbExtraPayment where Account like'%20190613200040011100840085071724%'
select reti,* from Topway..tbcash where coupno ='AS002554191'
select top 100* from Topway..HM_tbReti_tbReFundPayMent where Bak like '%AS002554191%'

--账单撤销
select SubmitState,* from Topway..AccountStatement 
--update Topway..AccountStatement  set SubmitState=1
where BillNumber='018021_20190521'

--行程单
select info3,* from Topway..tbcash
--update Topway..tbcash set info3='需打印行程单'
where coupno in('AS002500892','AS002525603','AS002528804','AS002529141','AS002529362')

--人员名单
select distinct cmpcode UC号,pasname 姓名,idno 证件号码 from Topway..tbcash with (nolock)
where datetime>='2018-01-01'
and inf=0
and reti=''
and cmpcode in('018919',
'020029',
'018589',
'017020',
'016428',
'019507')
order by cmpcode
