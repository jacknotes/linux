webpackJsonp([38],{"1Up2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),r=a("CCVD"),i=a("QRZS"),n=a("C0NF"),l=a("9Vmw"),o=a("4aFc"),c=a("EqUB"),d=a("DC+l"),u=a("gyMJ"),p=a("v2mk"),h={beforeRouteEnter:function(t,e,a){a(function(t){"/"===e.path||"/personal/center"===e.path?(t.travelType=0,t.orderStatus=0,""===t.PsgName?t._getDatalist():t.PsgName=""):"/train/bookConfirm"===e.path?(t.travelType=1===Number(t.$route.params.TravelType)?1:0,t._getDatalist()):"/train/changeRefund"===e.path?(t.orderStatus=0,t.travelType=1===Number(e.query.TravelType)?1:0,t._getDatalist()):"TrainOrderDetail"===e.name?(t.travelType=1===Number(t.$route.params.TravelType)?1:0,t._getDatalist()):t.datalist&&0!==t.datalist.length||t._getDatalist()})},beforeRouteLeave:function(t,e,a){"/train/trainQueryList"===t.path?(this.$router.replace("/personal/center"),this.travelType=0,this.dataStatus=0):a()},activated:function(){p.a.$off(),p.a.$on("refresh",function(){this._getDatalist()}.bind(this))},data:function(){return{datalist:[],travelType:0,tableViewOptions:{pullDownRefresh:{threshold:50},pullUpLoad:!1},currentPageIndex:1,currentPageSize:10,PsgName:"",orderStatus:0}},filters:{OrderStatus:function(t){switch(t){case-1:return s.a.prototype.$t("base.Unknown");case 1:return s.a.prototype.$t("base.BookingSucceed");case 2:return s.a.prototype.$t("base.ApplyForTicketing");case 3:return s.a.prototype.$t("base.WaitingForTicketing");case 4:return s.a.prototype.$t("base.Ticketing");case 5:return s.a.prototype.$t("base.TicketingSucceed");case 6:return s.a.prototype.$t("base.UserCanceled");case 7:return s.a.prototype.$t("base.NoticeCanceled");case 8:return s.a.prototype.$t("base.Unsubmitted");case 9:return s.a.prototype.$t("base.TicketingFailed");case 10:return s.a.prototype.$t("base.Refunding");case 11:return s.a.prototype.$t("base.PartialRefund");case 12:return s.a.prototype.$t("base.Refunded");case 13:return s.a.prototype.$t("base.Changing");case 14:return s.a.prototype.$t("base.PartialChange");case 15:return s.a.prototype.$t("base.ChangeSucceed");case 16:return s.a.prototype.$t("base.RefundFailed")}}},watch:{travelType:function(t){this._getDatalist()},PsgName:function(t){var e=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e._getDatalist()})}},methods:{_getDatalist:function(){var t=this;this.datalist=[],this.currentPageIndex=1,this.tableViewOptions.pullUpLoad=!1;var e={StartDate:this.beTimeNumber(this.beTime((new Date).setMonth((new Date).getMonth()-6))),EndDate:this.beTimeNumber(this.beTime(new Date)),PageIndex:this.currentPageIndex,PageSize:this.currentPageSize,Status:this.orderStatus,TravelType:this.travelType,PsgName:this.PsgName};Object(u._38)(e).then(function(e){t.datalist=e.ResultData.Orders,e.ResultData.Orders.length>=t.currentPageSize&&(t.tableViewOptions.pullUpLoad={threshold:50}),t.$refs.tableView&&t.$refs.tableView.forceUpdate()})},_getNextData:function(){var t=this;this.currentPageIndex++;var e={StartDate:this.beTimeNumber(this.beTime((new Date).setMonth((new Date).getMonth()-6))),EndDate:this.beTimeNumber(this.beTime(new Date)),PageIndex:this.currentPageIndex,PageSize:this.currentPageSize,Status:this.orderStatus,TravelType:this.travelType,PsgName:this.PsgName};Object(u._38)(e,!0).then(function(e){t.datalist=t.datalist.concat(e.ResultData.Orders),e.ResultData.Orders.length<t.currentPageSize?t.tableViewOptions.pullUpLoad=!1:t.tableViewOptions.pullUpLoad={threshold:50},t.$refs.tableView&&t.$refs.tableView.forceUpdate()})},_tabDelegate:function(t){this.orderStatus!==t&&(this.orderStatus=t,this._getDatalist())},_gotoDetails:function(t){this.$router.push({path:"/train/orderDetail",query:{Id:t,isOwner:!0}})},_gotoPay:function(t){var e=this;this.$alert({content:this.$t("TM.AreYouSureToPayForThisOrder"),cancelTxt:this.$t("base.Cancel"),confirmFn:function(){e.$refs.Pay&&e.$refs.Pay.gotoPay({OrderBusinessType:10,OrderID:t.OrderID,PayWay:3,TravelType:Number(e.TravelType),CallbackPathName:"TrainOrderInforList"})}})},_cancel:function(t){var e=this;this.$alert({content:this.$t("TM.AreYouSureToCancelTheOrder"),cancelTxt:this.$t("base.Cancel"),confirmFn:function(){var a={orderID:t.OrderID};Object(u._28)(a).then(function(t){!0===t.ResultData?(e.$toast(e.$t("TM.OrderCancelled")),e._getDatalist()):e.$toast(e.$t("TM.OrderCancelFailed"))})}})}},components:{CHeader:r.a,HsTab:i.a,HsScroll:n.a,HsSection:l.a,HsCell1:o.a,HsNull:c.a,eventBus:p.a,Pay:d.a}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hs-container"},[a("c-header",{attrs:{isBackNav:"",fixedBackPath:"/personal/center"}},[a("div",{staticClass:"header-title",attrs:{slot:"middle"},slot:"middle"},[a("p",[t._v(t._s(t.$t("base.TrainOrders")))])]),t._v(" "),a("div",{staticClass:"header-right",attrs:{slot:"right"},slot:"right"},[a("div",{staticClass:"travelTypeSwitch",on:{click:function(e){t.travelType=0===t.travelType?1:0}}},[a("div",{style:{transform:"translateX("+(0==t.travelType?"0px":"20px")+")"}},[a("p",[t._v(t._s(0===t.travelType?t.$t("base.B"):t.$t("base.P")))])])])])]),t._v(" "),a("div",{staticClass:"search-bar"},[a("div",{staticClass:"bar"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.PsgName,expression:"PsgName",modifiers:{trim:!0}}],attrs:{maxlength:"50",placeholder:t.$t("base.PleaseEnterThePassengerNameToSearch")},domProps:{value:t.PsgName},on:{input:function(e){e.target.composing||(t.PsgName=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"logo",staticStyle:{"background-image":"url('static/image/plane-ticket/book/search.png')"},on:{click:t._getDatalist}})])]),t._v(" "),a("hs-tab",{attrs:{selectedIndex:t.orderStatus,options:[t.$t("base.All"),t.$t("base.PendForOperating"),t.$t("base.Operating"),t.$t("base.Finished"),t.$t("base.Cancelled")]},on:{select:t._tabDelegate}}),t._v(" "),a("hs-scroll",{ref:"tableView",staticClass:"table-view",attrs:{data:t.datalist,options:t.tableViewOptions},on:{"pulling-down":t._getDatalist,"pulling-up":t._getNextData}},[t.noValue(JSON.stringify(t.datalist))?a("hs-null"):a("ul",[t._l(t.datalist,function(e,s){return a("div",{key:s,staticClass:"custom-cell",on:{click:function(a){t._gotoDetails(e.OrderID)}}},[0===s||s>0&&t.beTime(e.CreateDate,"MM-dd")!==t.beTime(t.datalist[s-1].CreateDate,"MM-dd")?a("div",{staticClass:"header"},[a("p",[t._v("\n            "+t._s(t.$t("base.OrderDate"))+":\n            "+t._s(t.$t(t.beTime(e.CreateDate),"date",t.beTime(e.CreateDate,"yyyy")===t.beTime(new Date,"yyyy")?["MM-dd","MM dd"]:["yyyy-MM-dd","MM dd, yyyy"]))+"\n          ")])]):t._e(),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"information"},[a("div",{staticClass:"left"},[e.OriginOrderID?a("div",{staticClass:"logo",style:{"background-image":"url('static/image/personal-center/changeTrain.png')"}}):a("div",{staticClass:"logo",style:{"background-image":"url('static/image/personal-center/train.png')"}})]),t._v(" "),a("div",{staticClass:"details"},t._l(e.Routes,function(s,r){return a("div",{key:r,staticClass:"blank"},[a("p",{staticClass:"title"},[t._v(t._s(s.DepartStationName)+" - "+t._s(s.ArrivalStationName))]),t._v(" "),a("p",[t._v(t._s(s.TrainCode)+"  "+t._s(t.beTime(s.DepartDate,"yyyy-MM-dd hh:mm")))]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"0px"}},[t._v(t._s(t.$t("base.Passenger"))+": "+t._s(e.Names))])])})),t._v(" "),a("div",{staticClass:"right"},[a("p",{staticClass:"price"},[t._v("￥"+t._s(e.TotalPrice))]),t._v(" "),a("p",{staticClass:"status"},[t._v(t._s(t._f("OrderStatus")(e.OrderStatus)))])])]),t._v(" "),a("div",{staticClass:"btns"},[e.PageBtnInfo.IsAllowPay?a("p",{on:{click:function(a){a.stopPropagation(),t._gotoPay(e)}}},[t._v(t._s(t.$t("base.Pay")))]):t._e(),t._v(" "),e.PageBtnInfo.IsAllowCancel?a("p",{on:{click:function(a){a.stopPropagation(),t._cancel(e)}}},[t._v(t._s(t.$t("base.Cancel")))]):t._e()])])])}),t._v(" "),t.tableViewOptions.pullUpLoad?t._e():a("p",{staticClass:"allLoadedTxt"},[t._v(t._s(t.$t("base.AllOrdersForRecentSixMonths")))])],2)],1),t._v(" "),a("pay",{ref:"Pay"})],1)},staticRenderFns:[]};var b=a("VU/8")(h,g,!1,function(t){a("8u3N")},"data-v-78575f2b",null);e.default=b.exports},"8u3N":function(t,e){}});
//# sourceMappingURL=38.f4edc9fdc0f887941d06.js.map