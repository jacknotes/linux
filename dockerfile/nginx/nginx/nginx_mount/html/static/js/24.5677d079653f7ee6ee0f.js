webpackJsonp([24],{dB70:function(t,e){},hiHF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),o=a("Dd8w"),n=a.n(o),r=a("mtWM"),l=a.n(r),c=a("CCVD"),d=a("QRZS"),u=a("C0NF"),h=a("9Vmw"),v=a("4aFc"),p=a("LrqJ"),_=a("EqUB"),m=a("bJna"),g=a("ANyL"),f=a("vgdM"),b=a("gyMJ"),y=a("6Qj3"),C=a("F+NM"),T=a("v2mk"),w=a("mT1R"),D=a("gSa9"),$=a("DC+l"),S=a("7+uW"),R=a("NYxO"),P={created:function(){this.noValue(this.$route.query.Id)?this.$router.replace("/planeTicket/orderList"):this.noValue(this.$route.query.Id)||this._getOrderDetails()},beforeRouteLeave:function(t,e,a){this.showReview||this.showTableTime?(this.showReview=!1,this.showTableTime=!1,a(!1)):("TrainOrderInforList"===t.name&&(t.params.TravelType=Number(this.details.TravelType),this.showPriceDetail=!1),a())},activated:function(){this.details={},T.a.$off(),T.a.$on("refund",function(){this._getOrderDetails()}.bind(this)),this._getOrderDetails()},computed:n()({},Object(R.c)(["isMiniprogram","trainRight","trainOrder"]),{infoIndex:function(){return this.details.VettingRecordInfos?this.details.VettingRecordInfos.map(function(t){return t.TemplateNodeProcessStatusDesc}).indexOf("进行中"):-1},goPrice:function(){return this.details.PriceDetails?this.details.PriceDetails.filter(function(t){return 0===t.Type}):[]},backPrice:function(){return this.details.PriceDetails?this.details.PriceDetails.filter(function(t){return 1===t.Type}):[]},ServiceCharge:function(){var t=this.details.PriceDetails?this.details.PriceDetails.reduce(function(t,e){return t+e.ServiceCharge*e.Amount},0):0;return t}}),data:function(){return{details:{},tableViewOptions:{pullDownRefresh:{threshold:50}},showPriceDetail:!1,showReview:!1,vettingContent:1,vettingMemo:"",showExamineDialog:!1,showTableTime:!1,currentTableTime:{},origin:{},isOrigin:"0",showTravelStandard:!1,showRulesDialog:!1,rulesHtml:""}},filters:{filterPayType:function(t){switch(t){case 1:return S.a.prototype.$t("base.CompanyPayment");case 2:return S.a.prototype.$t("base.PersonalPayment");case 3:return S.a.prototype.$t("base.CompanyPayment")+"("+S.a.prototype.$t("base.Prepayments")+")";default:return S.a.prototype.$t("base.Unknown")}},ticketStatus:function(t){switch(t){case 0:return S.a.prototype.$t("base.NotYetTicketed");case 1:return S.a.prototype.$t("base.Ticketing");case 2:return S.a.prototype.$t("base.TicketingFailed");case 3:return S.a.prototype.$t("base.Ticketed");case 4:return S.a.prototype.$t("base.ChangedRefund");case 5:return S.a.prototype.$t("base.Refunding");case 6:return S.a.prototype.$t("base.Refunded");case 7:return S.a.prototype.$t("base.Occupied");case 8:return S.a.prototype.$t("base.RefundFailed");case 9:return S.a.prototype.$t("base.ChangingTheStationThatArrived");default:return S.a.prototype.$t("base.Unknown")}}},methods:n()({},Object(R.d)(["SET_TRAIN_ORDER"]),Object(R.b)(["dispatchTrainRight"]),{_getOrderDetails:function(){var t=this,e={orderID:this.$route.query.Id};Object(b._37)(e).then(function(e){t.details=e.ResultData,t.origin=e.ResultData.OriginRoute?e.ResultData.OriginRoute:{},t.isOrigin=e.ResultData.OriginRoute?"1":"0"})},_getCancle:function(){var t=this;this.$alert({content:this.$t("TM.AreYouSureToCancelTheOrder"),cancelTxt:this.$t("base.Cancel"),confirmFn:function(){var e={orderID:t.$route.query.Id};Object(b._28)(e).then(function(e){!0===e.ResultData?(t.$toast(t.$t("TM.OrderCancelled")),setTimeout(function(){T.a.$emit("refresh")},0),t.$router.replace({name:"TrainOrderInforList",params:{TravelType:Number(t.details.TravelType)}})):t.$toast(t.$t("TM.OrderCancelFailed"))})}})},showDiaLog:function(){this.showPriceDetail?this.showPriceDetail=!1:this.showPriceDetail=!0},_clickGetOrder:function(){this.$router.push({path:"/train/book",query:{isExamine:!0}})},_showTipDialog:function(t,e,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.$t("base.Confirm"),i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.$t("base.Cancel");this.dialog=this.$createDialog({type:"confirm",icon:"cubeic-alert",title:this.$t("base.Tips"),content:t,confirmBtn:{text:s,active:!0,disabled:!1,href:"javascript:;"},cancelBtn:{text:i,active:!1,disabled:!1,href:"javascript:;"},onConfirm:e,onCancel:a}),this.dialog.show()},_gotoChange:function(t){var e=JSON.parse(i()(this.trainOrder));e.DepartObject={CityName_CN:t.DepartStationName,CityName_EN:t.DepartStationName,CityCode:t.DepartStationCode},e.ArrivalObject={CityName_CN:t.ArrivalStationName,CityName_EN:t.ArrivalStationName,CityCode:t.ArrivalStationCode},e.DepartStationCode=t.DepartStationCode,e.ArrivalStationCode=t.ArrivalStationCode,e.DepartStationName=t.DepartStationName,e.ArrivalStationName=t.ArrivalStationName,e.DepartDate=this.beTime(new Date),e.ArrivalDate="",e.OriginalOrderID=this.$route.query.Id,this.SET_TRAIN_ORDER(e),this.$router.push({path:"/train/trainQueryList",query:{originalDetails:i()(t),isOneWay:!0}})},_gotoRefund:function(t,e){var a=this,s={TrainCode:t,OrderID:this.details.OrderID};Object(b._33)(s).then(function(t){var e=t.ResultData;e.Route.Tickets&&(e.Route.Tickets=e.Route.Tickets.filter(function(t){return 3===t.IssueStatus}).map(function(t){return t.select=!1,t})),e.Route.Tickets&&e.Route.Tickets.length>0?a.$router.push({path:"/train/refund",query:{OrderID:a.details.OrderID,details:i()(e)}}):a.$toast(a.$t("TM.PassengersWithoutRefundableTickets"))})},_examineSubmit:function(){var t=this,e={ID:this.$route.query.Id,InstanceID:this.details.VettingRecordInfos[this.infoIndex].InstanceID,TemplateNodeID:this.details.VettingRecordInfos[this.infoIndex].TemplateNodeID,VettingContent:this.vettingContent,VettingMemo:this.vettingMemo,BusinessType:9};Object(b._66)(e).then(function(e){!0===e.ResultData&&t.$toast(t.$t("TM.ApprovalSubmitted"),{complete:function(){setTimeout(function(){T.a.$emit("refresh")},0),t.$router.replace({path:"/message/examine",query:{QuerySource:0}})}})})},_gotoPay:function(){this.$refs.Pay&&this.$refs.Pay.gotoPay({OrderBusinessType:10,OrderID:this.$route.query.Id,PayWay:3,TravelType:Number(this.details.TravelType),CallbackPathName:"TrainOrderInforList"})},_getTravelStandard:function(){var t=this;this.dispatchTrainRight().then(function(e){t.showTravelStandard=!0})},_showSegmentTitle:function(t){var e=this.details.Routes&&!this.noValue(i()(this.details.Routes))?this.details.Routes.length:0;return 1===e?this.$t("base.OneWay"):2===e&&this.details.Routes[0].DepartStationName===this.details.Routes[1].ArrivalStationName?0===t?this.$t("base.Going"):this.$t("base.Return"):this.$t("base.NoXSegment","function",t+1)},_getNoticeRules:function(){var t=this;l.a.get("/static/html/train_notice.html").then(function(e){t.rulesHtml=e.data,t.showRulesDialog=!0})}}),components:{CHeader:c.a,HsTab:d.a,HsScroll:u.a,HsSection:h.a,HsCell1:v.a,HsCellSmallTitle:p.a,HsNull:_.a,HsDialog:m.a,TrainSegment:g.a,HsButton:f.a,CReturnExplain:y.a,CExamineProcess:C.a,eventBus:T.a,HsAlert:w.a,CTravelStandard:D.a,Pay:$.a,CTableTime:function(){return a.e(69).then(a.bind(null,"fnlI"))}}},O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hs-container"},[a("c-header",{attrs:{title:t.$t("base.OrderDetails"),isBackNav:"",fixedBackPath:"/train/orderInfoList"}}),t._v(" "),t.details&&t.details.Routes?a("hs-scroll",{staticClass:"table-view",attrs:{data:[t.details],options:t.tableViewOptions},on:{"pulling-down":t._getOrderDetails}},[a("hs-section",[a("hs-cell-1",{attrs:{showLogo:!1}},[a("div",{staticClass:"cell-top"},[a("div",{staticClass:"cell-top-one",attrs:{type:t.language}},[a("p",[t._v(t._s(t.details.OrderStatusDesc))]),t._v(" "),a("p",[t._v(t._s(t.details.VettingStatusDesc))]),t._v(" "),a("p",[t._v(t._s(t.details.OrderStatusDesc))])]),t._v(" "),a("div",{staticClass:"cell-top-two"},[a("p",[t._v(t._s(t.$t("base.OrderNumber"))+": "+t._s(t.details.OrderNo))]),t._v(" "),a("p",[t._v(t._s(t.$t("base.OrderDate"))+": "+t._s(t.$t(t.beTime(t.details.CreateDate),"date",["yyyy-MM-dd","MM dd, yyyy"]))+" "+t._s(t.beTime(t.details.CreateDate,"hh:mm")))])]),t._v(" "),t.$route.query.isOwner?a("div",{staticClass:"cell-button"},[t.details.PageBtnInfo.IsAllowPay?a("hs-button",{staticClass:"button",on:{click:t._gotoPay}},[t._v(t._s(t.$t("base.Pay")))]):t._e(),t._v(" "),t.details.PageBtnInfo.IsAllowCancel?a("hs-button",{staticClass:"button",attrs:{type:"common"},on:{click:t._getCancle}},[t._v(t._s(t.$t("base.CancelOrder")))]):t._e()],1):t._e(),t._v(" "),t.infoIndex>=0&&t.$route.query.isExamine&&1===Number(t.details.VettingStatus)?a("div",{staticClass:"cell-button"},[a("hs-button",{staticClass:"button",on:{click:function(e){t.vettingContent=1,t.showExamineDialog=!0}}},[t._v(t._s(t.$t("base.Pass")))]),t._v(" "),a("hs-button",{staticClass:"button",attrs:{type:"common"},on:{click:function(e){t.vettingContent=0,t.showExamineDialog=!0}}},[t._v(t._s(t.$t("base.Reject")))])],1):t._e()])])],1),t._v(" "),this.noValue(JSON.stringify(t.origin))?t._e():a("train-segment",{attrs:{detail:t.origin,isOrigin:"1"}},t._l(t.origin.Tickets,function(e,s){return a("hs-cell-1",{key:s,attrs:{showLogo:!1,showSeparator:!1}},[a("div",{staticClass:"custom-cell-people"},[a("div",{staticClass:"left",style:{opacity:0===s?1:0}},[a("p",[t._v(t._s(t.$t("base.Passenger")))])]),t._v(" "),a("div",{staticClass:"right",style:{"border-bottom-width":s===t.origin.Tickets.length-1?"0px":"1px"}},[a("div",{staticClass:"name"},[a("p",[t._v(t._s(e.PsgName))]),t._v(" "),a("span",[t._v(t._s(t._f("ticketStatus")(e.IssueStatus)))])]),t._v(" "),a("div",{staticClass:"others"},[e.Credential?a("p",[t._v(t._s(e.Credential.CredentialName)+" "+t._s(e.Credential.CredentialNo))]):t._e(),t._v(" "),a("P",[t._v(t._s(t.$t("base.Seat"))+" "+t._s(e.SeatTypeName)+" "+t._s(e.SeatPosition))])],1)])])])})),t._v(" "),t._l(t.details.Routes,function(e,s){return a("div",{key:s},[a("train-segment",{attrs:{detail:e,isOrigin:(JSON.stringify(t.origin),"0"),mark:t._showSegmentTitle(s)}},[t._l(e.Tickets,function(s,i){return a("hs-cell-1",{key:i,attrs:{showLogo:!1,showSeparator:!1}},[a("div",{staticClass:"custom-cell-people",class:{"custom-line":0===i&&(5===t.details.OrderStatus||10===t.details.OrderStatus||11===t.details.OrderStatus||13===t.details.OrderStatus||14===t.details.OrderStatus)&&(new Date).valueOf()+72e5<1e3*e.DepartDate}},[a("div",{staticClass:"left",style:{opacity:0===i?1:0}},[a("p",[t._v(t._s(t.$t("base.Passenger")))])]),t._v(" "),a("div",{staticClass:"right",style:{"border-bottom-width":i===e.Tickets.length-1?"0px":"1px"}},[a("div",{staticClass:"name"},[a("p",[t._v(t._s(s.PsgName))]),t._v(" "),a("span",[t._v(t._s(t._f("ticketStatus")(s.IssueStatus)))])]),t._v(" "),a("div",{staticClass:"others"},[s.Credential?a("p",[t._v(t._s(s.Credential.CredentialName)+" "+t._s(s.Credential.CredentialNo))]):t._e(),t._v(" "),a("P",[t._v(t._s(t.$t("base.Seat"))+" "+t._s(s.SeatTypeName)+" "+t._s(s.SeatPosition))])],1)])])])}),t._v(" "),a("hs-cell-1",{attrs:{showLogo:!1}},[a("div",{staticClass:"cell-segment-one",attrs:{type:t.language}},[e.CanOperate?a("div",{staticClass:"cell-segment-button"},[a("div",{staticClass:"button",on:{click:function(a){t._gotoChange(e)}}},[t._v(t._s(t.$t("base.Change")))]),t._v(" "),a("div",{staticClass:"button",attrs:{type:"common"},on:{click:function(a){t._gotoRefund(e.TrainCode,e)}}},[t._v(t._s(t.$t("base.Refund")))])]):a("div"),t._v(" "),a("p",{on:{click:t._getNoticeRules}},[t._v(t._s(t.$t("base.BookingInstructionsAndInstructionsForReturning")))])])])],2)],1)}),t._v(" "),a("hs-section",[t.details.CustomItem&&t.details.DisplayConfig?a("hs-cell-small-title",{attrs:{title:t.details.DisplayConfig.CustomItemName,type:"bold",value:t.details.CustomItem,showLogo:!1}}):t._e(),t._v(" "),t.details.Purpose?a("hs-cell-small-title",{attrs:{title:t.$t("base.TravelPurpose"),type:"bold",value:t.details.Purpose,showLogo:!1}}):t._e(),t._v(" "),a("hs-cell-small-title",{attrs:{title:t.$t("base.BookingSource"),type:"bold",value:t.details.BookingSourceDesc,showLogo:!1}}),t._v(" "),"CN"===t.language?[t.details.VettingRecordInfos?a("hs-cell-small-title",{attrs:{title:t.$t("base.ApprovalInformation"),type:"bold"},nativeOn:{click:function(e){t.showReview=!0}}}):t._e()]:[t.details.VettingRecordInfos?a("hs-cell-small-title",{attrs:{title:t.$t("base.ApprovalInformation"),type:"bold",value:t.details.VettingStatusDesc},nativeOn:{click:function(e){t.showReview=!0}}}):t._e()],t._v(" "),0===Number(t.details.TravelType)?a("hs-cell-small-title",{attrs:{title:t.$t("base.PaymentWay"),type:"bold",value:t._f("filterPayType")(t.details.PayType),showLogo:!1}}):t._e(),t._v(" "),t.details.ReasonCode?a("hs-cell-small-title",{attrs:{title:t.$t("base.ViolationOfRank"),type:"bold",value:t.details.ReasonCode,warning:!1,showLogo:!1},on:{header:t._getTravelStandard}}):t._e()],2),t._v(" "),a("hs-section",t._l(t.details.Contacts,function(e,s){return a("hs-cell-1",{key:s,attrs:{showLogo:!1,showSeparator:!1}},[a("div",{staticClass:"custom-cell-people"},[a("div",{staticClass:"left",style:{opacity:0===s?1:0}},[a("p",[t._v(t._s(t.$t("base.ContactInformation")))])]),t._v(" "),a("div",{staticClass:"right",style:{"border-bottom-width":s===t.details.Contacts.length-1?"0px":"1px"}},[a("div",{staticClass:"name"},[t._v(t._s(e.Name))]),t._v(" "),a("div",{staticClass:"others"},[a("p",[t._v(t._s(t.$t("base.CellphoneNumber"))+" "+t._s(e.Mobile?e.Mobile:t.$t("base.Unfilled")))]),t._v(" "),a("p",[t._v(t._s(t.$t("base.Email"))+" "+t._s(e.Email?e.Email:t.$t("base.Unfilled")))])])])])])}))],2):t._e(),t._v(" "),a("div",{staticClass:"footer",on:{click:t.showDiaLog}},[a("div",{staticClass:"footer-price"},[a("p",[t._v(t._s(t.$t("base.TotalAmount")))]),t._v(" "),a("p",[t._v("¥"+t._s(t.details.TotalPrice))])]),t._v(" "),a("div",{staticClass:"footer-price-details"},[a("div",{staticClass:"logo",staticStyle:{"background-image":"url('static/image/base/cell/right_arrow_gray.png')"},style:{transform:t.showPriceDetail?"rotate(90deg)":"rotate(-90deg)"}})]),t._v(" "),a("hs-dialog",{ref:"dialog",attrs:{height:"calc(100% - 50px)"},model:{value:t.showPriceDetail,callback:function(e){t.showPriceDetail=e},expression:"showPriceDetail"}},[a("hs-scroll",{staticClass:"showPriceDetail"},[a("ul",[t._l(t.goPrice,function(e,s){return a("hs-cell-1",{key:s+"goPrice",attrs:{showLogo:!1}},[a("div",{staticClass:"footer-price-cell"},[a("p",[t._v(t._s(e.SeatTypeName)),"[]"!==JSON.stringify(t.backPrice)?[t._v("("+t._s(t.$t("base.Going"))+")")]:t._e()],2),t._v(" "),a("p",[a("span",[t._v("¥ "+t._s(e.Price)+" ")]),a("span",[t._v("x "+t._s(e.Amount))])])])])}),t._v(" "),t.backPrice.length>0?t._l(t.backPrice,function(e,s){return a("hs-cell-1",{key:s+"backPrice",attrs:{showLogo:!1}},[a("div",{staticClass:"footer-price-cell"},[a("p",[t._v(t._s(e.SeatTypeName)+"("+t._s(t.$t("base.Return"))+")")]),t._v(" "),a("p",[a("span",[t._v("¥ "+t._s(e.Price)+" ")]),a("span",[t._v("x "+t._s(e.Amount))])])])])}):t._e(),t._v(" "),a("hs-cell-1",{attrs:{showLogo:!1}},[a("div",{staticClass:"footer-price-cell"},[a("p",[t._v(t._s(t.$t("base.ServiceFee")))]),t._v(" "),a("p",[a("span",[t._v("¥ "+t._s(t.ServiceCharge))])])])])],2)])],1)],1),t._v(" "),a("c-examine-process",{attrs:{datalist:t.details.VettingRecordInfos,passengers:t.details.Passengers},model:{value:t.showReview,callback:function(e){t.showReview=e},expression:"showReview"}}),t._v(" "),a("hs-alert",{attrs:{show:t.showExamineDialog,title:1===t.vettingContent?t.$t("base.ApprovedPass"):t.$t("base.ApprovalRejection"),cancelBtn:"",maskClose:""},on:{"update:show":function(e){t.showExamineDialog=e},confirm:t._examineSubmit}},[a("div",{staticClass:"hs-alert-content",attrs:{slot:"content"},slot:"content"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.vettingMemo,expression:"vettingMemo"}],attrs:{maxlength:"50",placeholder:t.$t("base.PleaseEnterAComment")},domProps:{value:t.vettingMemo},on:{input:function(e){e.target.composing||(t.vettingMemo=e.target.value)}}})])]),t._v(" "),t.showTableTime?a("c-table-time",{attrs:{params:t.currentTableTime}}):t._e(),t._v(" "),a("c-travel-standard",{attrs:{details:t.trainRight.TrainRank,travelPolicy:t.trainRight.TravelPolicy,type:3},model:{value:t.showTravelStandard,callback:function(e){t.showTravelStandard=e},expression:"showTravelStandard"}}),t._v(" "),a("pay",{ref:"Pay"}),t._v(" "),a("hs-dialog",{model:{value:t.showRulesDialog,callback:function(e){t.showRulesDialog=e},expression:"showRulesDialog"}},[a("hs-scroll",{staticClass:"rulesDialog",attrs:{data:[t.rulesHtml]}},[a("ul",[a("div",{domProps:{innerHTML:t._s(t.rulesHtml)}})])])],1)],1)},staticRenderFns:[]};var k=a("VU/8")(P,O,!1,function(t){a("dB70")},"data-v-d4af48fe",null);e.default=k.exports}});
//# sourceMappingURL=24.5677d079653f7ee6ee0f.js.map